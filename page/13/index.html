<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>She11c0de&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="She11c0de&#39;s blogs">
<meta property="og:url" content="https://she11c0de.github.io/page/13/index.html">
<meta property="og:site_name" content="She11c0de&#39;s blogs">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="She11c0de">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/scrollUp/image.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 5.4.2"></head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div class="logo">
        <img src="/logo.png" alt="Profile Picture">
      </div>
      <div id="title">She11c0de's blogs</div>
      
       <ul class="my-socials">
  
 
</ul>
    </div>
  </div>
  <div id="header-inner" class="">
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <!--
        
          
            <a class="main-nav-link" href="/">首页</a>
          
            <a class="main-nav-link" href="/categories/life">生活</a>
          
            <a class="main-nav-link" href="/archives">归档</a>
          
        
      -->
    </nav>
    <nav id="title-nav" style="display:none">
      <a href="/">She11c0de&#39;s blogs</a>
      <img src="/logo.png" alt="Profile Picture">
      <!--
      <span id="title-nav-socials">
        
       
     </span>
      -->
    </nav>
    <nav id="sub-nav">
      
      <a id="nav-search-btn" class="nav-icon" title="Search"></a>
    </nav>
    <div id="search-form-wrap">
      <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
        <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="搜索">
        <input type="submit" value="" class="search-form-submit">
        <input name=tn type=hidden value="bds">
        <input name=cl type=hidden value="3">
        <input name=ct type=hidden value="2097152">
        <input type="hidden" name="si" value="she11c0de.github.io">
      </form>
    </div>
  </div>
  <div class="site-nav" style="display: none;">
    <ul>
      
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/categories/life">生活</a></li>
      
        <li><a href="/archives">归档</a></li>
      
      
    </ul>
  </div>
</header>
      <div class="outer">
        <section id="main">
  

    
    <article id="post-禅道/禅道8.2-9.2.1 注入GetShell" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%20%E6%B3%A8%E5%85%A5GetShell/" class="article-date">
  <time datetime="2022-07-08T06:26:09.623Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="禅道-8-2-9-2-1-注入-amp-getshell"><a href="#禅道-8-2-9-2-1-注入-amp-getshell" class="headerlink" title="禅道 8.2-9.2.1 注入&amp;getshell"></a>禅道 8.2-9.2.1 注入&amp;getshell</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>我这里用的官方集成环境版本8.4</p>
<pre><code>获取版本号：/index.php?mode=getconfig
</code></pre>
<p><img src="/resource/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/media/rId24.jpg"></p>
<p>绝对路径</p>
<p>获取绝对路径：网址后面随便输入什么就会爆出绝对路径</p>
<p><img src="/resource/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/media/rId25.jpg"></p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%20%E6%B3%A8%E5%85%A5GetShell/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%20%E6%B3%A8%E5%85%A5GetShell/" data-id="cl5c2qzyp00ouy8v1ged26v0l" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-禅道/禅道 11.6 远程命令执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%93%2011.6%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:09.621Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="禅道-11-6-远程命令执行漏洞"><a href="#禅道-11-6-远程命令执行漏洞" class="headerlink" title="禅道 11.6 远程命令执行漏洞"></a>禅道 11.6 远程命令执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>禅道项目管理软件是一款国产的，基于LGPL协议，开源免费的项目管理软件，它集产品管理、项目管理、测试管理于一体，同时还包含了事务管理、组织管理等诸多功能，是中小型企业项目管理的首选，基于自主的PHP开发框架──ZenTaoPHP而成，第三方开发者或企业可非常方便的开发插件或者进行定制。<br>厂商官网：<a target="_blank" rel="noopener" href="https://www.zentao.net/">https://www.zentao.net/</a><br>而此次发现的漏洞正是ZenTaoPHP框架中的通用代码所造成的的，因此禅道几乎所有的项目都受此漏洞影响</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>禅道 11.6</p>
<p>禅道开源版 9版本</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>一开始想要找的就是rce漏洞，所以通过寻找rce漏洞找到了禅道框架的漏洞，也是一个比较意外的收获吧。这里想要rce其实是文件写入+文件包含组合getshell的，所以只要我们都能够在model文件中找到这两类功能函数就能够达到我们的目的，另外这里可能有人会提出疑问，都能够写文件了，难道不能直接getshell嘛？这里写入的文件名没有经过base64解密，前面也说了禅道对于GET的参数其实是有多重限制的，像”.”也明显不在白名单规则里，所以最终放弃了这条路。<br>首先是文件写入漏洞，漏洞代码在module/editor/model.php中的save函数</p>
<p><img src="/resource/%E7%A6%85%E9%81%9311.6%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/media/rId25.png"></p>
<p>这里对文件写入内容作了一定黑名单的限制，这个绕过比较简单就不多说了，懂的人都懂，另外会对filePath做可写限制，因此这里如果是linux服务器部署的话，推荐写在/tmp目录下，毕竟没有什么限制，而且物理路径比较可控，如果想要../来跳转目录写入，这个是会失败的。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%93%2011.6%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%93%2011.6%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qzyp00oty8v1buq29b5y" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-禅道/禅道 11.6 任意文件读取" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%93%2011.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" class="article-date">
  <time datetime="2022-07-08T06:26:09.618Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="禅道-11-6-任意文件读取"><a href="#禅道-11-6-任意文件读取" class="headerlink" title="禅道 11.6 任意文件读取"></a>禅道 11.6 任意文件读取</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>禅道项目管理软件是一款国产的，基于LGPL协议，开源免费的项目管理软件，它集产品管理、项目管理、测试管理于一体，同时还包含了事务管理、组织管理等诸多功能，是中小型企业项目管理的首选，基于自主的PHP开发框架──ZenTaoPHP而成，第三方开发者或企业可非常方便的开发插件或者进行定制。<br>厂商官网：<a target="_blank" rel="noopener" href="https://www.zentao.net/">https://www.zentao.net/</a><br>而此次发现的漏洞正是ZenTaoPHP框架中的通用代码所造成的的，因此禅道几乎所有的项目都受此漏洞影响</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>禅道 11.6</p>
<p>禅道开源版 9版本</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>漏洞代码位于module/file/model.php中的parseCSV函数</p>
<p><img src="/resource/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/media/rId25.png"></p>
<p>这里通过上面的思路同样可以对fileName进行赋值，最终返回读取的文件数据<br>漏洞poc为：</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%93%2011.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%93%2011.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" data-id="cl5c2qzyp00osy8v10epx1fpc" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-禅道/禅道 11.6 sql注入漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%93%2011.6%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:09.616Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="禅道-11-6-sql注入漏洞"><a href="#禅道-11-6-sql注入漏洞" class="headerlink" title="禅道 11.6 sql注入漏洞"></a>禅道 11.6 sql注入漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>禅道项目管理软件是一款国产的，基于LGPL协议，开源免费的项目管理软件，它集产品管理、项目管理、测试管理于一体，同时还包含了事务管理、组织管理等诸多功能，是中小型企业项目管理的首选，基于自主的PHP开发框架──ZenTaoPHP而成，第三方开发者或企业可非常方便的开发插件或者进行定制。<br>厂商官网：<a target="_blank" rel="noopener" href="https://www.zentao.net/">https://www.zentao.net/</a><br>而此次发现的漏洞正是ZenTaoPHP框架中的通用代码所造成的的，因此禅道几乎所有的项目都受此漏洞影响</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>禅道 11.6</p>
<p>禅道开源版 9版本</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>禅道的注入在9版本当时也出现过，原理是limit后的参数采用了直接拼接，但是现在这个版本的禅道对所有的sql语句都做了转义处理，并且get参数都有严格的限制，不能出现&quot;()&quot;等特殊符号，所以说要想要通过get去注入获得数据，会显得非常困难，另外要提到的一点就是禅道很多参数都会有base64的解码，这其实也是一个比较不错的突破口，但是这里发现了一个更明显的sql注入漏洞。<br>漏洞代码位于module/api/model.php文件的sql函数</p>
<p><img src="/resource/%E7%A6%85%E9%81%9311.6sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/media/rId25.png"></p>
<p>这里其实是由很多限制的，比如说只能用select语句，并且其中可能还不能出现”()”这样的符号，因此这里只能采用最古老的的select语句去读数据库信息，虽然简单但是十分有效。<br>漏洞url:</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%93%2011.6%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%93%2011.6%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qzyo00ory8v13oethqtt" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-彩虹外链网盘/彩虹外链网盘 v4.0 重装getshell" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E9%87%8D%E8%A3%85getshell/" class="article-date">
  <time datetime="2022-07-08T06:26:09.528Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="彩虹外链网盘-v4-0-重装getshell"><a href="#彩虹外链网盘-v4-0-重装getshell" class="headerlink" title="彩虹外链网盘 v4.0 重装getshell"></a>彩虹外链网盘 v4.0 重装getshell</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>彩虹外链网盘 v4.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>在删除install.lock后,访问install.php<br>其他的原来的读取的配置,密码后面加上<code>&#39;;@eval($_REQUEST[xx]);//</code></p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0%E9%87%8D%E8%A3%85getshell/media/rId24.png" alt="13.png">{width=”5.833333333333333in”<br>height=”4.9203926071741035in”}</p>
<p>此时的config.php如下,而且由于我们用的是原来的配置,网站不会崩</p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0%E9%87%8D%E8%A3%85getshell/media/rId25.png" alt="14.png">{width=”5.833333333333333in”<br>height=”4.231375765529309in”}</p>
<p>代码执行成功</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E9%87%8D%E8%A3%85getshell/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E9%87%8D%E8%A3%85getshell/" data-id="cl5c2qzyo00oqy8v17afpgf3i" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-彩虹外链网盘/彩虹外链网盘 v4.0 后台任意文件删除漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:09.526Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="彩虹外链网盘-v4-0-后台任意文件删除漏洞"><a href="#彩虹外链网盘-v4-0-后台任意文件删除漏洞" class="headerlink" title="彩虹外链网盘 v4.0 后台任意文件删除漏洞"></a>彩虹外链网盘 v4.0 后台任意文件删除漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>彩虹外链网盘 v4.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>在admin.php传入act为del2,然后传入name为文件名就可以删除了</p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/media/rId24.png" alt="11.png">{width=”5.833333333333333in”<br>height=”2.5367639982502186in”}</p>
<p>调用的是storage.class.php中的delete函数然后掉用unlink,就不多说了</p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/media/rId25.png" alt="12.png">{width=”5.833333333333333in”<br>height=”2.5067563429571305in”}</p>

        
          <p class="article-more-link">
            <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qzyo00opy8v1ar706q1x" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-彩虹外链网盘/彩虹外链网盘 v4.0 任意文件读取漏洞（二）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/" class="article-date">
  <time datetime="2022-07-08T06:26:09.524Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="彩虹外链网盘-v4-0-任意文件读取漏洞（二）"><a href="#彩虹外链网盘-v4-0-任意文件读取漏洞（二）" class="headerlink" title="彩虹外链网盘 v4.0 任意文件读取漏洞（二）"></a>彩虹外链网盘 v4.0 任意文件读取漏洞（二）</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>彩虹外链网盘 v4.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>和上面注入在一个地方,list.php-&gt;display.func.php,然后调用了<br><code>$stor-&gt;get($name)</code></p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E(%E4%BA%8C)/media/rId24.png" alt="8.png">{width=”5.833333333333333in”<br>height=”1.718947944006999in”}</p>
<p>在storage.class.php中get方法调用了file_get_contents</p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E(%E4%BA%8C)/media/rId25.png" alt="9.png">{width=”5.833333333333333in”<br>height=”7.135921916010498in”}</p>
<p>在本地的宝塔环境成功读取配置文件管理员密码</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/" data-id="cl5c2qzyn00ony8v18wwzd2ny" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-彩虹外链网盘/彩虹外链网盘 v4.0 任意文件读取漏洞（一）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/" class="article-date">
  <time datetime="2022-07-08T06:26:09.521Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="彩虹外链网盘-v4-0-任意文件读取漏洞（一）"><a href="#彩虹外链网盘-v4-0-任意文件读取漏洞（一）" class="headerlink" title="彩虹外链网盘 v4.0 任意文件读取漏洞（一）"></a>彩虹外链网盘 v4.0 任意文件读取漏洞（一）</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>如果开启了开启open_basedir函数，则无法利用此漏洞</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>彩虹外链网盘 v4.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>回到一开始觉得可能存在文件读取的地方<br>在urlupload.php中接收到url传到curl_download函数</p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E(%E4%B8%80)/media/rId24.png" alt="5.png">{width=”5.833333333333333in”<br>height=”1.9474212598425198in”}</p>
<p>在main.func.php中看到curl_download函数其实就是调用curl_init讲道理是可以文件读取的</p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E(%E4%B8%80)/media/rId25.png" alt="6.png">{width=”5.833333333333333in”<br>height=”2.7040496500437445in”}</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/" data-id="cl5c2qzyo00ooy8v1fr9f002f" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-彩虹外链网盘/彩虹外链网盘 v4.0 sql注入漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:09.518Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="彩虹外链网盘-v4-0-sql注入漏洞"><a href="#彩虹外链网盘-v4-0-sql注入漏洞" class="headerlink" title="彩虹外链网盘 v4.0 sql注入漏洞"></a>彩虹外链网盘 v4.0 sql注入漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>彩虹外链网盘 v4.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>在list.php中第12行判断如果接收的act参数为view就调用view函数</p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/media/rId24.png" alt="1.png">{width=”5.833333333333333in”<br>height=”2.5791590113735783in”}</p>
<p>在list.php中的view函数内83行调用了viewfiles函数</p>
<p><img src="/resource/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98v4.0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/media/rId25.png" alt="2.png">{width=”5.833333333333333in”<br>height=”2.599246500437445in”}</p>
<p>viewfiles函数在\includes\display.func.php中<br>由于过滤的不严谨,可以直接联合查询,并有一个回显点</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98/%E5%BD%A9%E8%99%B9%E5%A4%96%E9%93%BE%E7%BD%91%E7%9B%98%20v4.0%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qzyn00omy8v1424q2663" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-宝塔/宝塔 Phpmyadmin 未授权访问漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/%E5%AE%9D%E5%A1%94/%E5%AE%9D%E5%A1%94%20Phpmyadmin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:26:09.501Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="宝塔-Phpmyadmin-未授权访问漏洞"><a href="#宝塔-Phpmyadmin-未授权访问漏洞" class="headerlink" title="宝塔 Phpmyadmin 未授权访问漏洞"></a>宝塔 Phpmyadmin 未授权访问漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Liunx版本7.4.2</p>
<p>windows版本6.8</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p><code>https://www.0-sec.org:888/pma/</code></p>
<p><img src="/resource/%E5%AE%9D%E5%A1%94Phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/media/rId24.png" alt="1.png"></p>

        
          <p class="article-more-link">
            <a href="/2022/07/07/%E5%AE%9D%E5%A1%94/%E5%AE%9D%E5%A1%94%20Phpmyadmin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/%E5%AE%9D%E5%A1%94/%E5%AE%9D%E5%A1%94%20Phpmyadmin%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qzym00oly8v19o9i0jii" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/12/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/101/">101</a><a class="extend next" rel="next" href="/page/14/">下一页</a>
    </nav>
  
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 She11c0de<br>
      Theme <a href="https://github.com/henryhuang/oishi" target="_blank">Oishi</a>, Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <!--
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/categories/life" class="mobile-nav-link">生活</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    -->
    

<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/jquery.scrollUp.min.js"></script>


<script src="/js/jquery.transform.js"></script>


<script src="/js/menu.js"></script>



<script src="/js/script.js"></script>


<script src="/js/scrollUp.js"></script>


  </div>
</body>
</html>